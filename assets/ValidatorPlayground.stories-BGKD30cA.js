import{r as _,R as n}from"./iframe-CBJir-8J.js";import{C as J,S as U,X as z,M as j,v as K}from"./validateBasics-DEY3oNcw.js";import"./preload-helper-PPVm8Dsz.js";function W(e){return e.replace(/\*\*/g,"").replace(/\*/g,"").replace(/__/g,"").replace(/_/g,"").replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"').replace(/[\u2013\u2014]/g,"-").replace(/\u2212/g,"-").replace(/\u00A0/g," ").replace(/\n/g," ").replace(/\s+/g," ").trim()}function H(e){const a=W(e),d=e.split(`
`).map(l=>l.trim()).filter(Boolean),t={name:W(d[0]||"Unnamed Creature"),classLevels:[],feats:[],str:10,dex:10,con:10,int:10,wis:10,cha:10,hp:10,ac:10,fort:0,ref:0,will:0,bab:0,cr:"1",size:"Medium",type:"humanoid"},c=/(?:CR|Challenge Rating)\s*(\d+(?:[\/\.]\d+)?)/i,o=/XP\s*([0-9,]+)/i,m=/(LG|NG|CG|LN|N|CN|LE|NE|CE)\s+(Fine|Diminutive|Tiny|Small|Medium|Large|Huge|Gargantuan|Colossal)\s+([a-zA-Z\-\s]+)/i,f=/AC\s*(\d+)/i,s=/touch\s*(\d+)/i,i=/flat-footed\s*(\d+)/i,r=/(?:hp|HP)\s*(\d+)\s*(?:\(([^)]+)\))?/i,p=/Fort\s*\+?(-?\d+),\s*Ref\s*\+?(-?\d+),\s*Will\s*\+?(-?\d+)/i,h=/(?:Base Atk|Base Atk\.|Base Attack)\s*\+?(\d+)/i,u=/CMD\s*(\d+)/i,G=/Feats[:\s]+(.+?)(?:;|$|Skills|Languages|SQ|Ecology|Special Abilities)/i,X=/Treasure\s+(.+?)(?:$|\n|Special)/i,$=a.match(c);$&&(t.cr=$[1]);const M=a.match(o);M&&(t.xp=parseInt(M[1].replace(/,/g,"")));const y=a.match(m);y&&(t.alignment=y[1],t.size=y[2],t.type=y[3].trim());const I=a.match(f);I&&(t.ac_claimed=parseInt(I[1]));const R=a.match(s);R&&(t.touch_ac_claimed=parseInt(R[1]));const E=a.match(i);E&&(t.flat_footed_ac_claimed=parseInt(E[1]));const v=a.match(r);if(v){t.hp_claimed=parseInt(v[1]),t.hp=parseInt(v[1]);const l=v[2];if(l){const N=/(\d+)d/.exec(l);N&&(t.racialHD=parseInt(N[1]))}}const g=a.match(p);g&&(t.fort_save_claimed=parseInt(g[1]),t.fort=parseInt(g[1]),t.ref_save_claimed=parseInt(g[2]),t.ref=parseInt(g[2]),t.will_save_claimed=parseInt(g[3]),t.will=parseInt(g[3]));const S=a.match(h);S&&(t.bab_claimed=parseInt(S[1]),t.bab=parseInt(S[1]));const C=a.match(u);C&&(t.cmd_claimed=parseInt(C[1]),t.cmd=parseInt(C[1]));const B=/Str\s*(\d+)/i.exec(a),T=/Dex\s*(\d+)/i.exec(a),w=/Con\s*(\d+)/i.exec(a),F=/Int\s*(\d+)/i.exec(a),A=/Wis\s*(\d+)/i.exec(a),b=/Cha\s*(\d+)/i.exec(a);B&&(t.str=parseInt(B[1])),T&&(t.dex=parseInt(T[1])),w&&(t.con=parseInt(w[1])),F&&(t.int=parseInt(F[1])),A&&(t.wis=parseInt(A[1])),b&&(t.cha=parseInt(b[1]));const P=a.match(G);P&&(t.feats=P[1].split(/[,;]+/).map(l=>l.trim()).filter(Boolean));const D=a.match(X);if(D){const l=D[1].toLowerCase();l.includes("npc gear")?t.treasureType="NPC Gear":l.includes("standard")?t.treasureType="Standard":l.includes("double")?t.treasureType="Double":l.includes("triple")?t.treasureType="Triple":l.includes("incidental")?t.treasureType="Incidental":l.includes("none")&&(t.treasureType="None")}return t}function Q(e){const{name:a,cr:d,xp:t,size:c,type:o}=e,m=e.alignment||"N",f=d,s=h=>Math.floor((h-10)/2),i=h=>{const u=s(h);return u>=0?`+${u}`:`${u}`},p=`${e.racialHD||1}d8+${s(e.con)}`;return`
${a}
CR ${f}
XP ${t?.toLocaleString()||"0"}
${m} ${c} ${o}
Init ${i(e.dex)}; Senses Perception +0
DEFENSE
AC ${e.ac_claimed||e.ac}, touch ${e.touch_ac_claimed||e.touch||10}, flat-footed ${e.flat_footed_ac_claimed||e.flatFooted||10}
hp ${e.hp_claimed||e.hp} (${p})
Fort +${e.fort_save_claimed||e.fort}, Ref +${e.ref_save_claimed||e.ref}, Will +${e.will_save_claimed||e.will}
OFFENSE
Speed 30 ft.
Melee weapon +${e.bab_claimed||e.bab} (1d8)
STATISTICS
Str ${e.str}, Dex ${e.dex}, Con ${e.con}, Int ${e.int}, Wis ${e.wis}, Cha ${e.cha}
Base Atk +${e.bab_claimed||e.bab}; CMB +${(e.bab_claimed||e.bab)+s(e.str)}; CMD ${e.cmd_claimed||e.cmd||10}
Feats ${e.feats?.join(", ")||"None"}
Treasure ${e.treasureType||"Standard"}
`.trim()}function L(e){const a=JSON.parse(JSON.stringify(e));let d=a.racialHD||0,t=0;const c=a.classLevels||[];for(const i of c){const r=J[i.className];if(!r){d+=i.level||0;continue}d+=i.level||0,r.babProgression==="Fast"?t+=i.level:r.babProgression==="Medium"?t+=Math.floor((i.level||0)*.75):t+=Math.floor((i.level||0)*.5)}d===0&&c.length===0&&(t=a.bab_claimed??a.bab??0),a.bab_claimed=t,a.bab=t;const o=U[a.size]||{cmbCmdMod:0},m=Math.floor(((a.str??10)-10)/2),f=Math.floor(((a.dex??10)-10)/2);a.cmd_claimed=10+t+m+f+(o.cmbCmdMod||0),a.cmd=a.cmd_claimed;let s=a.cr;return z[s]&&(a.xp=z[s]),a}function Z(e){const a=[],d=typeof e.cr=="number"?e.cr:parseInt(String(e.cr),10);if(isNaN(d))return{valid:!0,messages:a,status:"PASS"};const t=j.find(s=>s.cr===String(e.cr)||s.cr===e.cr_text);if(!t)return{valid:!0,messages:a,status:"PASS"};const c=e.hp_claimed??e.hp??void 0;if(c!==void 0&&typeof c=="number"){const s=c/t.hp;s<.7?a.push({severity:"warning",category:"benchmarks",message:`HP ${c} is dangerously low (<70%) for CR ${e.cr} (Benchmark: ${t.hp}). Creature is a "Glass Jaw".`}):s>1.5&&a.push({severity:"warning",category:"benchmarks",message:`HP ${c} is significantly high (>150%) for CR ${e.cr} (Benchmark: ${t.hp}). It may be a "Damage Sponge".`})}const o=e.ac_claimed??e.ac??void 0;if(o!==void 0&&typeof o=="number"){const s=o-t.ac;s<-3?a.push({severity:"warning",category:"benchmarks",message:`AC ${o} is very low (-${Math.abs(s)}) for CR ${e.cr} (Benchmark: ${t.ac}).`}):s>5&&a.push({severity:"warning",category:"benchmarks",message:`AC ${o} is very high (+${s}) for CR ${e.cr} (Benchmark: ${t.ac}).`})}const m=[{name:"Fort",val:e.fort_save_claimed},{name:"Ref",val:e.ref_save_claimed},{name:"Will",val:e.will_save_claimed}];for(const s of m)s.val!==void 0&&typeof s.val=="number"&&s.val<t.poorSave-2&&a.push({severity:"warning",category:"benchmarks",message:`${s.name} Save +${s.val} is critically weak for CR ${e.cr} (Benchmark Poor Save: +${t.poorSave}).`});return{valid:!a.some(s=>s.severity==="error"),messages:a,status:a.length>0?"WARN":"PASS"}}const V=`Fire Beetle
CR 1/3
XP 135
N Small vermin
Init +0; Senses Perception +0
DEFENSE
AC 12, touch 11, flat-footed 12
hp 4 (1d8)
Fort +2, Ref +0, Will +0
OFFENSE
Speed 30 ft.
Melee bite +1 (1d4)
STATISTICS
Str 10, Dex 11, Con 11, Int 10, Wis 10, Cha 7
Base Atk +0; CMB -1; CMD 9
Feats Weapon Finesse
Treasure None`,O=()=>{const[e,a]=_.useState(V),[d,t]=_.useState(()=>L(H(V))),[c,o]=_.useState([]),m=s=>{const i=s.currentTarget.value;a(i);try{const r=H(i),p=L(r);t(p);const h=K(r),u=Z(r);o([h,u])}catch(r){console.error("Parse error:",r)}},f=s=>{switch(s){case"error":return"#dc2626";case"warning":return"#ea580c";case"info":return"#2563eb"}};return n.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem",padding:"1rem",fontFamily:"system-ui, sans-serif",height:"100vh",boxSizing:"border-box"}},n.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}},n.createElement("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600}},"ðŸ“ Raw Stat Block"),n.createElement("textarea",{value:e,onChange:m,style:{flex:1,padding:"0.75rem",fontFamily:"monospace",fontSize:"0.875rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",resize:"none",lineHeight:1.5},spellCheck:!1})),n.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",overflow:"auto"}},n.createElement("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600}},"âš–ï¸ Validation Results"),n.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"}},c.map((s,i)=>n.createElement("div",{key:i,style:{border:"1px solid #d1d5db",borderRadius:"0.375rem",padding:"0.75rem",backgroundColor:"#f9fafb"}},n.createElement("div",{style:{fontWeight:600,marginBottom:"0.5rem"}},s.messages[0]?.category||"Validation"),s.messages.length===0?n.createElement("div",{style:{color:"#059669",fontWeight:500}},"âœ“ PASS"):n.createElement("ul",{style:{margin:0,paddingLeft:"1.5rem"}},s.messages.map((r,p)=>n.createElement("li",{key:p,style:{color:f(r.severity),marginBottom:"0.25rem",fontSize:"0.875rem"}},n.createElement("strong",null,r.severity.toUpperCase(),":")," ",r.message,r.expected!==void 0&&n.createElement("div",{style:{fontSize:"0.75rem",marginTop:"0.25rem",color:"#6b7280"}},"Expected: ",JSON.stringify(r.expected)," | Actual: ",JSON.stringify(r.actual))))))))),n.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}},n.createElement("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600}},"âœ¨ Auto-Fixed Version"),n.createElement("textarea",{value:Q(d),readOnly:!0,style:{flex:1,padding:"0.75rem",fontFamily:"monospace",fontSize:"0.875rem",border:"1px solid #10b981",borderRadius:"0.375rem",resize:"none",backgroundColor:"#f0fdf4",lineHeight:1.5},spellCheck:!1})))};O.__docgenInfo={description:"",methods:[],displayName:"ValidatorPlayground"};const ee={title:"Validators/Rules Lawyer Workbench",component:O,parameters:{layout:"fullscreen"}},x={};x.parameters={...x.parameters,docs:{...x.parameters?.docs,source:{originalSource:"{}",...x.parameters?.docs?.source}}};const te=["InteractiveWorkbench"];export{x as InteractiveWorkbench,te as __namedExportsOrder,ee as default};
