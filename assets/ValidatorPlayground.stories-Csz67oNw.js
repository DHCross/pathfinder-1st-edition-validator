import{r as _,R as s}from"./iframe-BrWmImZI.js";import{s as ue,f as j}from"./pf1e-formatter-B4nenv3l.js";import{M as Z,C as X,a as ne,S as ce,X as Q}from"./pf1e-data-tables-BqrvN3By.js";import{v as te,a as he}from"./validateEconomy-BPxQKqyz.js";import{v as ae,g as se,e as ge}from"./benchmarkUtils-5DkscLZ_.js";import{V as Se}from"./ValidatorDisplay-SHMbd9aW.js";import"./preload-helper-PPVm8Dsz.js";function be(o){return o.replace(/\*\*/g,"").replace(/\*/g,"").replace(/__/g,"").replace(/_/g,"").replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"').replace(/[\u2013\u2014]/g,"-").replace(/\u2212/g,"-").replace(/\u00A0/g," ").trim()}function ve(o){const a=be(o),t={name:a.split(`
`).map(r=>r.trim()).filter(Boolean)[0]||"Unnamed Creature",classLevels:[],feats:[],str:10,dex:10,con:10,int:10,wis:10,cha:10,hp:10,ac:10,fort:0,ref:0,will:0,bab:0,cr:"1",size:"Medium",type:"Humanoid"};t.raw_text=a;const i=a.match(/Melee\s+(.+?)(?=\n|Ranged|Space|Special|Str|Statistic)/i);if(i&&(t.melee_line="Melee "+i[1].trim()),t.melee_line){const r=[],d=t.melee_line.replace(/^Melee\s+/i,"").split(/,\s*/);for(const f of d){const p=f.match(/^(?<name>[A-Za-z\-\s]+)\s*\+?(?<to>[-+]?\d+)?\s*(?:\((?<paren>.*)\))?/i);if(!p||!p.groups)continue;const y=(p.groups.name||"").trim(),H=p.groups.to?parseInt(p.groups.to):void 0;let D,L;if(p.groups.paren){const N=p.groups.paren,G=N.match(/(\d+d\d+(?:\s*[+-]\s*\d+)?)/i);G&&(D=G[1].replace(/\s+/g,""));const O=N.replace(G?G[0]:"","").trim();O&&(L=O.replace(/^\+\s*/,"").trim())}r.push({name:y,toHit:H,damage:D,effect:L})}t.meleeAttacks=r}const T=a.match(/Ranged\s+(.+?)(?=\n|Space|Special|Str|Statistic)/i);T&&(t.ranged_line="Ranged "+T[1].trim());const v=a.match(/Speed\s+(.+?)(?=\n|Melee|Ranged|Space|Special|Str|Statistic)/i);v&&(t.speed_line="Speed "+v[1].trim());const S=a.match(/Special Attacks\s+(.+?)(?=\n|Str|Statistic|Spells)/i);S&&(t.special_attacks_line="Special Attacks "+S[1].trim());const u=a.match(/(?:Spells|Spell-Like).+?(?=STATISTICS|Str\s+\d)/s);u&&(t.spells_block=u[0].trim());const C=a.match(/SPECIAL ABILITIES(.+)$/s);C&&(t.special_abilities_block=`SPECIAL ABILITIES
`+C[1].trim());const h=a.match(/Skills\s+(.+?)(?=\n|Languages|SQ|Feats|Special|Gear|Treasure)/i);h&&(t.skills_line="Skills "+h[1].trim());const A=a.match(/Languages\s+(.+?)(?=\n|SQ|Feats|Special|Gear|Treasure)/i);A&&(t.languages_line="Languages "+A[1].trim());const E=a.match(/(?:Combat Gear|Other Gear|Equipment)\s+(.+?)(?=\n|Special|Treasure)/is);E&&(t.equipment_line="Equipment "+E[1].trim());const W=a.match(/(?:CR|Challenge Rating)\s*(\d+(?:[\/\.]\d+)?)/i);W&&(t.cr=W[1]);const w=a.match(/XP\s*([0-9,]+)/i);w&&(t.xp=parseInt(w[1].replace(/,/g,"")));const k=a.match(/(LG|NG|CG|LN|N|CN|LE|NE|CE)\s+(Fine|Diminutive|Tiny|Small|Medium|Large|Huge|Gargantuan|Colossal)\s+([a-zA-Z\-\s\(\)]+?)(?=\s*(?:Init|Senses|CR|Level|\d))/i);if(k){t.alignment=k[1],t.size=k[2];const r=k[3].trim();t.subtypes=r.split(/,\s*/).map(d=>d.trim()).filter(Boolean),/Fiend|Devil|Demon|Daemon|Angel|Archon|Azata|Chaos-Beast/i.test(r)?t.type="Outsider":/Dragon/i.test(r)?t.type="Dragon":/Undead/i.test(r)?t.type="Undead":/Beast/i.test(r)?t.type="Magical Beast":t.type=r.split(" ")[0]}const m=/(Barbarian|Bard|Cleric|Druid|Fighter|Monk|Paladin|Ranger|Rogue|Sorcerer|Wizard|Adept|Aristocrat|Commoner|Expert|Warrior)\s+(\d+)/gi;let g;for(;(g=m.exec(a))!==null;)t.classLevels?.push({className:g[1],level:parseInt(g[2])});const B=a.match(/AC\s*(\d+)/i);B&&(t.ac_claimed=parseInt(B[1]));const R=a.match(/touch\s*(\d+)/i);R&&(t.touch_ac_claimed=parseInt(R[1]));const F=a.match(/flat-?footed\s*(\d+)/i);F&&(t.flat_footed_ac_claimed=parseInt(F[1]));const M=a.match(/(?:hp|HP)\s*(\d+)\s*(?:\(([^)]+)\))?/);if(M&&(t.hp_claimed=parseInt(M[1]),t.hp=parseInt(M[1]),M[2])){const r=/(\d+)d/.exec(M[2]);r&&(t.racialHD=parseInt(r[1]))}const I=t.classLevels?.reduce((r,d)=>r+d.level,0)||0;t.racialHD===I&&I>0&&(t.racialHD=0);const P=a.match(/Fort\s*\+?(-?\d+),\s*Ref\s*\+?(-?\d+),\s*Will\s*\+?(-?\d+)/i);P&&(t.fort_save_claimed=parseInt(P[1]),t.ref_save_claimed=parseInt(P[2]),t.will_save_claimed=parseInt(P[3]));const $=a.match(/(?:Base Atk|Base Atk\.|Base Attack)\s*\+?(\d+)/i);$&&(t.bab_claimed=parseInt($[1]));const l=a.match(/CMD\s*(\d+)/i);l&&(t.cmd_claimed=parseInt(l[1]));const n=(r,d)=>{const f=new RegExp(`${d}\\s*(\\d+|[\\u2013\\u2014\\-])`,"i"),p=r.match(f);if(!p)return 10;const y=p[1];return/\d/.test(y)?parseInt(y):0};t.str=n(a,"Str"),t.dex=n(a,"Dex"),t.con=n(a,"Con"),t.int=n(a,"Int"),t.wis=n(a,"Wis"),t.cha=n(a,"Cha"),t.ac_claimed&&(t.ac=t.ac_claimed),t.touch_ac_claimed&&(t.touch=t.touch_ac_claimed),t.flat_footed_ac_claimed&&(t.flatFooted=t.flat_footed_ac_claimed);const b=a.match(/Init\s*([+-]?\d+)/i);b&&(t.init_claimed=parseInt(b[1]));const c=a.match(/Perception\s*([+-]?\d+)/i);c&&(t.perception_claimed=parseInt(c[1]));const x=a.match(/Feats[:\s]+(.+?)(?=\n|Skills|Languages|SQ|Ecology|Special Abilities)/i);x&&(t.feats=x[1].split(/[,;]/).map(r=>r.trim()).filter(Boolean));const V=a.match(/Treasure\s+(.+?)(?:$|\n)/i);if(V){const r=V[1].toLowerCase();r.includes("npc gear")?t.treasureType="NPC Gear":(r.includes("standard"),t.treasureType="Standard")}return t}function xe(o,a="enforce_cr"){const e=JSON.parse(JSON.stringify(o)),t=[],i=(r,d,f,p)=>{d!=f&&t.push({feature:r,oldValue:d,newValue:f,reason:p})},T=[{find:/\bWisdom Save(s)?\b/ig,replace:"Will Save",reason:'PF1e uses Will saves instead of "Wisdom Save"'},{find:/\bDexterity Save(s)?\b/ig,replace:"Reflex Save",reason:'PF1e uses Reflex saves instead of "Dexterity Save"'},{find:/\bConstitution Save(s)?\b/ig,replace:"Fortitude Save",reason:'PF1e uses Fortitude saves instead of "Constitution Save"'},{find:/\bBonus Action\b/ig,replace:"Swift Action",reason:"PF1e uses Swift Action for bonus-like uses"},{find:/\bReaction\b/ig,replace:"Immediate Action",reason:"PF1e uses Immediate Action or AoO semantics"},{find:/\bAction\b/ig,replace:"Standard Action",reason:'Prefer explicit "Standard Action" wording'},{find:/\bDeception\b/ig,replace:"Bluff",reason:"PF1e uses Bluff"},{find:/\bPersuasion\b/ig,replace:"Diplomacy",reason:"PF1e uses Diplomacy/Intimidate"},{find:/\bInsight\b/ig,replace:"Sense Motive",reason:"PF1e uses Sense Motive"},{find:/\bAthletics\b/ig,replace:"Climb/Swim",reason:"PF1e splits Athletics into Climb/Swim/etc."}],v=(r,d)=>{if(!d)return d;let f=d;for(const p of T)if(p.find.test(f)){const y=f.replace(p.find,p.replace);y!==f&&(i(`${r} (terminology)`,f,y,p.reason),f=y)}return f};if(e.special_abilities_block=v("special_abilities_block",e.special_abilities_block),e.melee_line=v("melee_line",e.melee_line),e.skills_line=v("skills_line",e.skills_line),e.feats&&e.feats.length){const r=e.feats.map(d=>{let f=d;for(const p of T)f=f.replace(p.find,p.replace);return f.trim()});r.join("|")!==(e.feats||[]).join("|")&&(i("Feats (terminology)",(e.feats||[]).join(", "),r.join(", "),"Normalize skill/save/action names to PF1e equivalents"),e.feats=r)}if(a==="enforce_cr"){const r=Z.find(d=>d.cr===e.cr);if(r){const f=(X[e.type]||{hitDieType:8}).hitDieType/2+.5,p=Math.floor(((e.con||10)-10)/2),y=Math.max(1,f+p),H=e.hp_claimed||e.hp;if(H>r.hp*1.5){const D=Math.max(1,Math.round(r.hp/y));if((e.classLevels||[]).length===0){const L=e.racialHD;e.racialHD=D;const N=Math.floor(e.racialHD*f)+e.racialHD*p;e.hp=N,e.hp_claimed=N,i("Hit Dice",L,D,`Reduced to match CR ${e.cr} Benchmark`),i("Hit Points",H,N,`Recalculated for ${D} HD`)}}}}let S=0;if(e.racialHD&&e.racialHD>0){const r=X[e.type];let d="medium";r&&(d=r.babProgression),d==="fast"?S+=e.racialHD:d==="medium"?S+=Math.floor(e.racialHD*.75):S+=Math.floor(e.racialHD*.5)}for(const r of e.classLevels||[]){const d=ne[r.className];d&&(d.babProgression==="fast"?S+=r.level:d.babProgression==="medium"?S+=Math.floor(r.level*.75):S+=Math.floor(r.level*.5))}(e.racialHD||0)===0&&(e.classLevels||[]).length===0&&(S=e.bab_claimed??e.bab??0);const u=e.bab_claimed??e.bab;S!==u&&(i("Base Attack Bonus",u,S,`Fixed based on ${e.racialHD||0} HD (${e.type}) + Class Levels`),e.bab=S,e.bab_claimed=S);const C=ce[e.size]||{acAttackMod:0,cmbCmdMod:0},h=Math.floor(((e.str??10)-10)/2),A=Math.floor(((e.dex??10)-10)/2),E=10+S+h+A+(C.cmbCmdMod||0),W=e.cmd_claimed??e.cmd;E!==W&&(i("CMD",W,E,`Recalculated: 10 + BAB(${S}) + Str(${h}) + Dex(${A}) + Size(${C.cmbCmdMod})`),e.cmd=E,e.cmd_claimed=E);const w=S+h+(C.cmbCmdMod||0),k=e.cmb;w!==k&&(i("CMB",k,w,`Recalculated: BAB(${S}) + Str(${h}) + Size(${C.cmbCmdMod})`),e.cmb=w);const m=(e.racialHD??0)+(e.classLevels||[]).reduce((r,d)=>r+(d.level||0),0),g=Math.floor(2+m/2),B=Math.floor(m/3),R=X[e.type]||{goodSaves:[]},F=(R.goodSaves?.includes("Fort")?g:B)+Math.floor(((e.con??10)-10)/2),M=(R.goodSaves?.includes("Ref")?g:B)+Math.floor(((e.dex??10)-10)/2),I=(R.goodSaves?.includes("Will")?g:B)+Math.floor(((e.wis??10)-10)/2),P=e.fort_save_claimed??e.fort;F!==P&&(i("Fort Save",P,F,`Recalculated for ${m} HD and con ${e.con}`),e.fort=F,e.fort_save_claimed=F);const $=e.ref_save_claimed??e.ref;M!==$&&(i("Ref Save",$,M,`Recalculated for ${m} HD and dex ${e.dex}`),e.ref=M,e.ref_save_claimed=M);const l=e.will_save_claimed??e.will;I!==l&&(i("Will Save",l,I,`Recalculated for ${m} HD and wis ${e.wis}`),e.will=I,e.will_save_claimed=I);const n=Math.floor(((e.dex??10)-10)/2),b=e.init_claimed??void 0;if(n!==b&&(i("Init",b,n,`Set to Dex modifier ${n}`),e.init_claimed=n),a==="fix_math"){const r=e.hp_claimed||e.hp;if(r>0){const d=Z.find(f=>f.cr===e.cr);if(d&&r>d.hp*1.5){const f=Z.find(p=>r>=p.hp*.85&&r<=p.hp*1.25);f&&(i("Challenge Rating",e.cr,f.cr,`Upgraded to match HP (${r})`),e.cr=f.cr,e.cr_text=f.cr)}}}let c=e.cr_text||e.cr.toString();if(c==="0.5"&&(c="1/2"),(c==="0.33"||c==="0.333")&&(c="1/3"),c==="0.25"&&(c="1/4"),(c==="0.16"||c==="0.166"||c==="0.167")&&(c="1/6"),c==="0.125"&&(c="1/8"),Q[c]){const r=Q[c];e.xp!==r&&(i("XP Award",e.xp,r,`Standardized for CR ${c}`),e.xp=r)}const x=e.ac_claimed||e.ac,V=10+A+C.acAttackMod;return x>V?e.ac=x:e.ac=Math.max(x,V),{block:e,fixes:t}}const ye=`New Creature
CR 1
XP 400
N Medium Humanoid
Init +0; Senses Perception +0
DEFENSE
AC 12, touch 11, flat-footed 12
hp 20 (2d8+4)
Fort +2, Ref +0, Will +0
OFFENSE
Speed 30 ft.
Melee unarmed +1 (1d4)
STATISTICS
Str 10, Dex 10, Con 14, Int 10, Wis 10, Cha 10
Base Atk +1; CMB +1; CMD 12
Feats Improved Initiative
Treasure Standard`,ie=o=>{if(o==null)return;let a=typeof o=="number"?o.toString():String(o).trim();return a==="0.5"&&(a="1/2"),(a==="0.33"||a==="0.333")&&(a="1/3"),a==="0.25"&&(a="1/4"),(a==="0.16"||a==="0.166"||a==="0.167")&&(a="1/6"),a==="0.125"&&(a="1/8"),a},de=o=>{if(!o)return 0;const a=o.racialHD??0,e=(o.classLevels||[]).reduce((t,i)=>t+(i.level||0),0);return a+e},U=o=>Math.floor(((o??10)-10)/2),ee=o=>{if(!o)return 0;let a=0;const e=o.racialHD??0;if(e>0){const i=X[o.type]?.babProgression??"medium";i==="fast"?a+=e:i==="medium"?a+=Math.floor(e*.75):a+=Math.floor(e*.5)}for(const t of o.classLevels||[]){const i=ne[t.className];i&&(i.babProgression==="fast"?a+=t.level:i.babProgression==="medium"?a+=Math.floor(t.level*.75):a+=Math.floor(t.level*.5))}return e===0&&(o.classLevels||[]).length===0&&(a=o.bab??0),a},Y=o=>{if(!o)return null;const a=ee(o),e=ce[o.size]?.cmbCmdMod??0;return 10+a+U(o.str)+U(o.dex)+e},re=o=>{if(!o)return null;const a=Math.max(1,de(o)),e=Math.floor(2+a/2),t=Math.floor(a/3),i=X[o.type]||{goodSaves:[]};return{fort:(i.goodSaves?.includes("Fort")?e:t)+U(o.con),ref:(i.goodSaves?.includes("Ref")?e:t)+U(o.dex),will:(i.goodSaves?.includes("Will")?e:t)+U(o.wis),totalHD:a}},le={ok:{bg:"#ecfdf5",color:"#047857",label:"On target"},high:{bg:"#fef3c7",color:"#b45309",label:"High / Sponge"},low:{bg:"#fee2e2",color:"#b91c1c",label:"Low / Glass Jaw"}},oe=(o,a)=>{if(o==null||a===void 0||a===null||a===0)return"ok";const e=(o-a)/a;return e>.2?"high":e<-.2?"low":"ok"},_e=({initialText:o=ye,initialFixMode:a="enforce_cr"})=>{const[e,t]=_.useState(o),[i,T]=_.useState(null),[v,S]=_.useState(1),[u,C]=_.useState(a),[h,A]=_.useState(null),[E,W]=_.useState([]),[w,k]=_.useState(null),m=u==="enforce_cr"?h:i;_.useEffect(()=>{if(!e.trim()){T(null),A(null),k(null),W([]);return}try{const l=ve(e);T(l);const n=parseInt(l.cr,10);S(isNaN(n)?1:n)}catch(l){console.error(l)}},[e]),_.useEffect(()=>{if(!i)return;let l=JSON.parse(JSON.stringify(i));const n=[],b=i.cr,c=v.toString();if(b!==c){const z=Q[c];if(z){const{block:me,changes:fe}=ue(l,z);l=me,fe.forEach(pe=>n.push({feature:"Creature Scaler",oldValue:b,newValue:c,reason:pe}))}}const{block:x,fixes:V}=xe(l,u);A(x),W([...n,...V]);const d=te(i).messages.filter(z=>z.category==="structure"),p=ae(i).messages.filter(z=>z.severity!=="note"),y=u==="enforce_cr"?x:i;let H={status:"PASS",messages:[]},D={status:"PASS",messages:[]},L={status:"PASS",messages:[]};y&&(H=te(y),D=ae(y),L=he(y));const N=[...d,...p,...H.messages||[],...D.messages||[],...L.messages||[]],G=d.some(z=>z.severity==="critical"),O=H.status==="FAIL"||L.status==="FAIL";k({valid:!G&&!O,status:G||O?"FAIL":H.status==="WARN"||D.status==="WARN"||L.status==="WARN"?"WARN":"PASS",messages:N})},[i,v,u]);const g=_.useMemo(()=>{if(!i)return null;const l=i.cr_text??i.cr??v,n=ie(l)??ie(v),b=se(l),c=ge(l),x=de(i);return{crLabel:i.cr,totalHD:x,hdEstimate:c,hdMax:c?c*2:null,canonicalXP:n?Q[n]:void 0,hpBenchmark:b?.hp,hpActual:i.hp_claimed??i.hp}},[i,v]),B=_.useMemo(()=>{if(!m)return[];const l=m.cr_text??m.cr??v,n=se(l);if(!n)return[];const b=Y(m);return[{key:"hp",label:"HP Budget",actual:m.hp_claimed??m.hp,expected:n.hp,helper:"Keep HP within Â±20% of CR baseline."},{key:"ac",label:"Armor Class",actual:m.ac_claimed??m.ac,expected:n.ac,helper:"AC swings over 4 points skew encounter math."},{key:"cmd",label:"CMD Health",actual:m.cmd_claimed??m.cmd??null,expected:b,helper:"Legal CMD uses BAB + Str + Dex + size."}].filter(c=>c.actual!==void 0&&c.actual!==null&&c.expected!==void 0&&c.expected!==null).map(c=>({...c,status:oe(c.actual,c.expected)}))},[m,v]),R=_.useMemo(()=>re(m),[m]),F=_.useMemo(()=>Y(m),[m]),M=_.useMemo(()=>ee(m),[m]),I=()=>{h&&t(j(h))},P=()=>{if(!i)return;const l=ee(i),n=re(i),b=Y(i),c={...i,bab:l??i.bab,bab_claimed:l??i.bab_claimed,fort:n?.fort??i.fort,ref:n?.ref??i.ref,will:n?.will??i.will,fort_save_claimed:n?.fort??i.fort_save_claimed,ref_save_claimed:n?.ref??i.ref_save_claimed,will_save_claimed:n?.will??i.will_save_claimed,cmd:b??i.cmd,cmd_claimed:b??i.cmd_claimed};t(j(c))},$=l=>{if(!m||!R)return null;const n=m[`${l.toLowerCase()}`],b=R[l.toLowerCase()],c=oe(n,b),x=le[c];return s.createElement("div",{key:l,style:{borderRadius:8,padding:"0.5rem 0.75rem",background:x.bg,border:`1px solid ${x.color}33`,display:"flex",flexDirection:"column",gap:2}},s.createElement("div",{style:{fontSize:12,fontWeight:700,color:x.color}},l),s.createElement("div",{style:{fontSize:18,fontWeight:700}},typeof n=="number"?`+${n}`:"â€”"),s.createElement("div",{style:{fontSize:11,color:"#475569"}},"Legal: ",b!==void 0?`+${b}`:"â€”"))};return s.createElement("div",{className:"validator-playground"},s.createElement("div",{className:"validator-column"},s.createElement("h2",{className:"validator-header"},"1. Raw Stat Block"),s.createElement("textarea",{className:"validator-textarea",value:e,onChange:l=>t(l.target.value),spellCheck:!1,placeholder:"Paste stat block here..."})),s.createElement("div",{className:"validator-scroll-area"},s.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"}},s.createElement("h3",{className:"validator-header"},"2. Rules Lawyer Audit (v3.0)"),s.createElement("div",{style:{fontSize:"0.85rem",color:"#6b7280"}},"Validating: ",u==="enforce_cr"?"Auto-Fixed Version (Design Mode)":"Raw Input (Audit Mode)"),g&&s.createElement("div",{style:{border:"1px solid #c7d2fe",background:"#eef2ff",borderRadius:12,padding:"0.75rem",display:"flex",flexDirection:"column",gap:6}},s.createElement("div",{style:{fontWeight:700,color:"#312e81"}},"HD / CR Guardrail"),s.createElement("div",{style:{fontSize:13,color:"#312e81"}},"Declared CR ",g.crLabel," expects roughly ",g.hdEstimate??"â€”"," HD (",g.hpBenchmark??"â€”"," hp). This block lists ",g.totalHD," HD."),g.hdMax!==null&&g.hdMax!==void 0&&g.totalHD>g.hdMax&&s.createElement("div",{style:{fontSize:12,color:"#b45309",fontWeight:600}},"Warning: Structural errors fire above ",g.hdMax," HD for this CR."),s.createElement("div",{style:{display:"flex",gap:8,flexWrap:"wrap"}},g.canonicalXP&&s.createElement("span",{style:{padding:"4px 10px",borderRadius:999,background:"#312e81",color:"white",fontSize:12,fontWeight:600}},"XP locked: ",g.canonicalXP),typeof g.hpActual=="number"&&s.createElement("span",{style:{fontSize:12,color:"#475569"}},"Claimed HP: ",g.hpActual))),B.length>0&&s.createElement("div",{style:{display:"grid",gap:8,gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))"}},B.map(l=>{const n=le[l.status];return s.createElement("div",{key:l.key,style:{borderRadius:12,padding:"0.75rem",border:`1px solid ${n.color}33`,background:n.bg,boxShadow:"0 4px 12px rgba(15,23,42,0.05)"}},s.createElement("div",{style:{fontSize:11,fontWeight:700,color:n.color,textTransform:"uppercase"}},l.label),s.createElement("div",{style:{fontSize:26,fontWeight:700,color:"#0f172a",lineHeight:1.2}},l.actual),s.createElement("div",{style:{fontSize:12,color:"#475569"}},"Benchmark: ",l.expected??"â€”"),s.createElement("div",{style:{marginTop:6,fontSize:12,fontWeight:600,color:n.color}},n.label),s.createElement("div",{style:{fontSize:11,color:"#475569",marginTop:4}},l.helper))})),m&&s.createElement("div",{style:{border:"1px solid #e2e8f0",borderRadius:12,padding:"0.75rem",background:"#f8fafc",display:"flex",flexDirection:"column",gap:10}},s.createElement("div",{style:{fontWeight:700,color:"#0f172a"}},"Chassis Snapshot"),s.createElement("div",{style:{display:"flex",flexWrap:"wrap",gap:10}},s.createElement("div",{style:{minWidth:120}},s.createElement("div",{style:{fontSize:11,color:"#475569"}},"BAB"),s.createElement("div",{style:{fontSize:20,fontWeight:700}},"+",m.bab," ",s.createElement("span",{style:{fontSize:12,color:"#94a3b8"}},"legal +",M))),s.createElement("div",{style:{minWidth:120}},s.createElement("div",{style:{fontSize:11,color:"#475569"}},"CMD"),s.createElement("div",{style:{fontSize:20,fontWeight:700}},m.cmd??"â€”",s.createElement("span",{style:{fontSize:12,color:"#94a3b8",marginLeft:4}},"legal ",F??"â€”")))),R&&s.createElement("div",{style:{display:"flex",gap:8,flexWrap:"wrap"}},["Fort","Ref","Will"].map(l=>$(l))),s.createElement("div",{style:{display:"flex",gap:8,flexWrap:"wrap"}},s.createElement("button",{type:"button",onClick:P,style:{padding:"6px 12px",borderRadius:8,border:"1px solid #a5b4fc",background:"#eef2ff",color:"#4338ca",fontWeight:600,cursor:"pointer"}},"Recalculate CMD & Saves"),s.createElement("button",{type:"button",onClick:I,disabled:!h,style:{padding:"6px 12px",borderRadius:8,border:"1px solid #22c55e",background:"#dcfce7",color:"#15803d",fontWeight:600,cursor:h?"pointer":"not-allowed",opacity:h?1:.6}},"Overwrite Raw with Auto-Fix"))),i&&w&&s.createElement(Se,{statBlock:u==="enforce_cr"?h:i,validation:w,validationTarget:u==="enforce_cr"?"fixed":"raw"})),E.length>0&&s.createElement("div",{className:"fix-report"},s.createElement("h4",{className:"fix-report-header"},"ðŸ› ï¸ Auto-Fixes Applied (",u==="fix_math"?"Audit Mode":"Design Mode",")"),s.createElement("ul",{className:"fix-list"},E.map((l,n)=>s.createElement("li",{key:`${l.feature}-${n}`,className:"fix-item"},s.createElement("div",{style:{fontWeight:600}},l.feature),s.createElement("div",{className:"fix-change-row"},s.createElement("span",{className:"fix-old"},String(l.oldValue)),s.createElement("span",null,"â†’"),s.createElement("span",{className:"fix-new"},String(l.newValue))),s.createElement("div",{className:"fix-reason"},l.reason)))))),s.createElement("div",{className:"validator-column"},s.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"}},s.createElement("h2",{className:"validator-header"},"3. Auto-Fixed Version"),s.createElement("div",{className:"mode-toggle",style:{display:"flex",alignItems:"center",gap:"1rem"}},s.createElement("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",backgroundColor:"#f3f4f6",padding:"0.25rem 0.5rem",borderRadius:"0.25rem"}},s.createElement("label",{htmlFor:"cr-slider",style:{fontSize:"0.75rem",fontWeight:"bold",color:"#4b5563"}},"Target CR: ",v),s.createElement("input",{id:"cr-slider",type:"range",min:"1",max:"20",value:v,onChange:l=>S(parseInt(l.target.value,10)),style:{width:100}})),s.createElement("div",{style:{display:"flex",backgroundColor:"#e5e7eb",borderRadius:"0.25rem",padding:"0.25rem"}},s.createElement("button",{onClick:()=>C("enforce_cr"),style:{backgroundColor:u==="enforce_cr"?"white":"transparent",color:u==="enforce_cr"?"#1d4ed8":"#4b5563",fontWeight:u==="enforce_cr"?"bold":"normal",boxShadow:u==="enforce_cr"?"0 1px 2px 0 rgba(0, 0, 0, 0.05)":"none",padding:"0.25rem 0.75rem",fontSize:"0.75rem",borderRadius:"0.25rem",border:"none",cursor:"pointer"},title:"Keep CR, downgrade stats"},"Design Mode"),s.createElement("button",{onClick:()=>C("fix_math"),style:{backgroundColor:u==="fix_math"?"white":"transparent",color:u==="fix_math"?"#1d4ed8":"#4b5563",fontWeight:u==="fix_math"?"bold":"normal",boxShadow:u==="fix_math"?"0 1px 2px 0 rgba(0, 0, 0, 0.05)":"none",padding:"0.25rem 0.75rem",fontSize:"0.75rem",borderRadius:"0.25rem",border:"none",cursor:"pointer"},title:"Keep stats, update CR label"},"Audit Mode")))),s.createElement("div",{className:"output-area"},h?s.createElement("pre",{className:"output-pre"},j(h)):s.createElement("p",{style:{color:"#9ca3af",fontSize:"0.875rem",fontStyle:"italic"}},"Fixes will appear here.")),s.createElement("button",{onClick:()=>h&&navigator.clipboard.writeText(j(h)),className:"copy-btn",disabled:!h,style:{opacity:h?1:.6,cursor:h?"pointer":"not-allowed"}},"ðŸ“‹ Copy to Clipboard")))},Me=`Rat King Prime
CR 1
XP 400
CE Small Outsider
Init +6; Senses darkvision 60 ft.; Perception +9
DEFENSE
AC 20, touch 15, flat-footed 16 (+1 size, +4 Dex, +5 natural)
hp 42 (6d8+12)
Fort +9, Ref +9, Will +6
OFFENSE
Speed 30 ft., climb 20 ft.
Melee bite +12 (1d4+6 plus disease)
STATISTICS
Str 18, Dex 18, Con 14, Int 12, Wis 12, Cha 8
Base Atk +6; CMB +9; CMD 24
Feats Weapon Finesse, Lightning Reflexes, Toughness
Skills Acrobatics +14, Stealth +15, Perception +9
Languages Abyssal
Special Abilities
Disease (Bite) Filth Fever (DC 14)`,Ce=`Glass Scout
CR 4
XP 1,200
N Medium Humanoid (human)
Init +1; Senses Perception +4
DEFENSE
AC 14, touch 11, flat-footed 13 (+3 armor, +1 Dex)
hp 22 (3d8+9)
Fort +2, Ref +2, Will +4
OFFENSE
Speed 30 ft.
Melee longsword +4 (1d8+1)
STATISTICS
Str 12, Dex 12, Con 12, Int 10, Wis 14, Cha 8
Base Atk +2; CMB +3; CMD 14
Feats Alertness, Iron Will
Skills Perception +4, Survival +8
Languages Common`,Fe={title:"Validators/Rules Lawyer Workbench",component:_e,parameters:{layout:"fullscreen",controls:{exclude:["initialText"]}},args:{initialFixMode:"enforce_cr"}},J={name:"Design Mode (HD/CR Guardrails)",args:{initialText:Me,initialFixMode:"enforce_cr"},parameters:{docs:{description:{story:"Demonstrates the HD/CR guardrail banner, benchmark tiles, and quick chassis helpers when forcing a CR 1 overbuilt stat block back into line."}}}},K={name:"Audit Mode (Benchmark Warnings)",args:{initialText:Ce,initialFixMode:"fix_math"},parameters:{docs:{description:{story:"Shows the Rules Lawyer in Audit Mode, highlighting glass-jaw HP/AC deviations and letting reviewers compare raw inputs against legal chassis targets."}}}},q={name:"Sandbox"};J.parameters={...J.parameters,docs:{...J.parameters?.docs,source:{originalSource:`{
  name: 'Design Mode (HD/CR Guardrails)',
  args: {
    initialText: OVERBUILT_SAMPLE,
    initialFixMode: 'enforce_cr'
  },
  parameters: {
    docs: {
      description: {
        story: 'Demonstrates the HD/CR guardrail banner, benchmark tiles, and quick chassis helpers when forcing a CR 1 overbuilt stat block back into line.'
      }
    }
  }
}`,...J.parameters?.docs?.source}}};K.parameters={...K.parameters,docs:{...K.parameters?.docs,source:{originalSource:`{
  name: 'Audit Mode (Benchmark Warnings)',
  args: {
    initialText: UNDERBUILT_SAMPLE,
    initialFixMode: 'fix_math'
  },
  parameters: {
    docs: {
      description: {
        story: 'Shows the Rules Lawyer in Audit Mode, highlighting glass-jaw HP/AC deviations and letting reviewers compare raw inputs against legal chassis targets.'
      }
    }
  }
}`,...K.parameters?.docs?.source}}};q.parameters={...q.parameters,docs:{...q.parameters?.docs,source:{originalSource:`{
  name: 'Sandbox'
}`,...q.parameters?.docs?.source}}};const Ie=["BenchmarkGuardrails","AuditModeGlassJaw","InteractiveWorkbench"];export{K as AuditModeGlassJaw,J as BenchmarkGuardrails,q as InteractiveWorkbench,Ie as __namedExportsOrder,Fe as default};
