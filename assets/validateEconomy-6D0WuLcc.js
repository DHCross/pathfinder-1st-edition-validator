import{C,a as P,M as w,S as _,X as z,W as D,T as O}from"./pf1e-data-tables-BqrvN3By.js";function B(e){const s=[];let t=!1,i=e.racialHD||0,a=0;if(e.racialHD&&e.racialHD>0){const r=C[e.type];r?r.babProgression==="fast"?a+=e.racialHD:r.babProgression==="medium"?a+=Math.floor(e.racialHD*.75):a+=Math.floor(e.racialHD*.5):a+=Math.floor(e.racialHD*.75)}for(const r of e.classLevels||[]){const u=P[r.className];u&&(i+=r.level,u.babProgression==="fast"?a+=r.level:u.babProgression==="medium"?a+=Math.floor(r.level*.75):a+=Math.floor(r.level*.5))}const p=(e.cr||"").toString(),l=w.find(r=>r.cr===p);if(l){const r=Math.max(1,Math.round((l.hp||1)/4.5)),u=r*2;i>u&&i>=3&&(t=!0,s.push({category:"structure",severity:"critical",message:`HD/CR Mismatch: ${i} Hit Dice is inappropriate for CR ${e.cr}. This HD count suggests a much higher CR than declared and is a structural contradiction.`,expected:`${r} HD (max ${u})`,actual:`${i} HD`}))}const d=_[e.size]||{cmbCmdMod:0},n=Math.floor(((e.str||10)-10)/2),c=Math.floor(((e.dex||10)-10)/2);let $="MATCH";e.bab_claimed!==void 0&&e.bab_claimed!==a&&($="MISMATCH",t=!0,s.push({category:"basics",severity:"critical",message:`Base Attack Bonus (BAB) +${e.bab_claimed} is illegal for ${i} HD. It must be +${a} according to ${e.type} progression.`,expected:a,actual:e.bab_claimed}));const m=10+a+n+c+d.cmbCmdMod,H=10+(e.bab_claimed||0)+n+c+d.cmbCmdMod;e.cmd_claimed&&(e.cmd_claimed===m||(e.cmd_claimed===H&&$==="MISMATCH"?s.push({category:"basics",severity:"warning",message:`CMD ${e.cmd_claimed} matches the source's (incorrect) BAB of +${e.bab_claimed}. If BAB were corrected to +${a}, CMD would be ${m}.`,expected:m,actual:e.cmd_claimed}):(t=!0,s.push({category:"basics",severity:"critical",message:`Calculated CMD is ${m} (10 + Legal BAB ${a} + Str ${n} + Dex ${c} + Size ${d.cmbCmdMod}), but stat block claims ${e.cmd_claimed}.`,expected:m,actual:e.cmd_claimed}))));const v=Math.ceil(i/2),h=e.feats?.length||0;h<v&&s.push({category:"basics",severity:"warning",message:`Creature has ${i} HD and should have at least ${v} feats, but only lists ${h}.`,expected:v,actual:h});const y=z[e.cr];y&&e.xp!==y&&(t=!0,s.push({category:"basics",severity:"critical",message:`XP ${e.xp} does not match canonical value ${y} for CR ${e.cr}. (Source: Core Rulebook Experience Point Awards table)`,expected:y,actual:e.xp}));const f=C[e.type];f&&typeof f.hitDieType=="number"&&f.hitDieType<6&&s.push({category:"basics",severity:"warning",message:`Nonstandard Hit Die: ${e.type} is mapped to d${f.hitDieType} HD which is below the conventional minimum of d6 for monster racial HD. d4 is usually reserved for damage dice, not racial HD.`,expected:"d6+",actual:`d${f.hitDieType}`});const o={Tiny:{str:3,dex:16,con:10},Small:{str:8,dex:14,con:10},Medium:{str:10,dex:10,con:10},Large:{str:18,dex:8,con:14},Huge:{str:26,dex:6,con:18},Gargantuan:{str:34,dex:6,con:22},Colossal:{str:42,dex:6,con:26}}[e.size];if(o){const u=Math.abs((e.str||10)-o.str),R=Math.abs((e.dex||10)-o.dex),S=Math.abs((e.con||10)-o.con);u>4&&s.push({category:"basics",severity:"warning",message:`STR ${e.str} deviates significantly from ${e.size} baseline of ${o.str}. Physical scores should be "relatively close" to size-appropriate values.`,expected:`~${o.str}`,actual:e.str}),R>4&&s.push({category:"basics",severity:"warning",message:`DEX ${e.dex} deviates significantly from ${e.size} baseline of ${o.dex}. Physical scores should be "relatively close" to size-appropriate values.`,expected:`~${o.dex}`,actual:e.dex}),S>4&&s.push({category:"basics",severity:"note",message:`CON ${e.con} deviates from ${e.size} baseline of ${o.con}. High CON is OK for durability; verify intentional.`,expected:`~${o.con}`,actual:e.con})}const g=e.template,x={Skeleton:["Undead"],Zombie:["Undead"],Lich:["Undead"],Ghost:["Undead"]};if(g&&x[g]){const r=x[g];r.includes(e.type)&&s.push({category:"basics",severity:"warning",message:`Template "${g}" is typically applied to non-Undead creatures. Applying to ${e.type} (Undead type) may be redundant or contradictory.`,expected:`Non-${r[0]} creature type`,actual:e.type})}const T=(e.str||10)===10&&(e.dex||10)===10&&(e.con||10)===10,A=(e.int||10)===10&&(e.wis||10)===10&&(e.cha||10)===10,L=(e.racialHD||1)===1,N=(e.ac_claimed||10)<=10,E=typeof e.cr=="number"?e.cr:parseInt(String(e.cr),10);return T&&A&&L&&N&&(E||1)<=.33&&s.push({category:"basics",severity:"note",message:"Creature has minimum baseline stats (all 10s, 1 HD, AC ≤10, CR ≤1/3). This is appropriate for minions, commoners, or lowest-tier threats.",expected:"Varies",actual:"All baselines"}),{valid:!t,status:t?"FAIL":s.length>0?"WARN":"PASS",messages:s}}function F(e){const s=[];if(e.gearValue===void 0)return{valid:!0,messages:[{severity:"note",category:"economy",message:"No gear value provided; skipping economy validation."}]};const t=W(e),i=b(e,t);if(i===null)return s.push({severity:"warning",category:"economy",message:`Unable to determine expected wealth for ${t} tier.`}),{valid:!0,messages:s};const a=e.gearValue,l=(a-i)/i*100,d=15;Math.abs(l)<=d?s.push({severity:"note",category:"economy",message:`Wealth is on target for ${t} (${a} gp vs expected ${i} gp).`,expected:i,actual:a}):l>d?s.push({severity:"warning",category:"economy",message:`Over-geared: ${t} has ${a} gp, expected ~${i} gp (+${l.toFixed(1)}%).`,expected:i,actual:a}):s.push({severity:"warning",category:"economy",message:`Under-geared: ${t} has ${a} gp, expected ~${i} gp (${l.toFixed(1)}%).`,expected:i,actual:a});let n="PASS";return s.some(c=>c.severity==="critical")?n="FAIL":s.some(c=>c.severity==="warning")&&(n="WARN"),{valid:Math.abs(l)<=d,messages:s,status:n}}function W(e){if(e.economicTier)return e.economicTier;const s=e.racialHD||0,t=e.classLevels||[],i=["Warrior","Expert","Commoner","Adept","Aristocrat"],p=t.filter(n=>!i.includes(n.className)).reduce((n,c)=>n+c.level,0),d=t.filter(n=>i.includes(n.className)).reduce((n,c)=>n+c.level,0);return p>=s&&p>0?"Heroic NPC":d>0?"Basic NPC":"Monster"}function b(e,s){if(s==="Heroic NPC"){const t=M(e);return t<1||t>20?null:D.heroicNpc[t]||null}if(s==="Basic NPC"){const t=M(e);return t<1||t>20?null:D.basicNpc[t]||null}if(s==="Monster"){const t=e.cr,i=O[t];if(!i)return null;let a=i.medium;return e.treasureType==="Double"?a*=2:e.treasureType==="Triple"?a*=3:e.treasureType==="Incidental"?a*=.5:e.treasureType==="None"&&(a=0),a}return null}function M(e){if(e.claimedEffectiveLevel!==void 0)return e.claimedEffectiveLevel;const s=e.racialHD||0,i=(e.classLevels||[]).reduce((a,p)=>a+p.level,0);return s+i}export{F as a,B as v};
