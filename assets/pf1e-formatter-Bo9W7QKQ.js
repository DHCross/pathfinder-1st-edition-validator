import{M as I,C as E,S as v,X as H}from"./pf1e-data-tables-BqrvN3By.js";const c=["Fine","Diminutive","Tiny","Small","Medium","Large","Huge","Gargantuan","Colossal"];function O(e,t){const s=c.indexOf(e);if(s===-1)return e;const i=Math.max(0,Math.min(c.length-1,s+t));return c[i]}function w(e){let t="1",s=1/0;for(const[i,u]of Object.entries(H)){const r=Math.abs(u-e);r<s&&(s=r,t=i)}return t}function L(e,t){const s=JSON.parse(JSON.stringify(e)),i=[],u=e.xp||400,r=t/u,h=w(t),p=I.find(o=>o.cr===h);if(!p)return i.push(`Could not find stats for CR ${h}`),{block:s,changes:i};if(r<=.75){const o=s.size;c.indexOf(o)>3&&(s.size=O(o,-1),i.push(`Reduced Size from ${o} to ${s.size} (Weak Tier)`)),s.str=Math.max(1,(s.str||10)-4),s.con=Math.max(1,(s.con||10)-4),i.push("Reduced Str/Con by -4 (Weak Tier)")}r>=1.25&&(s.str=(s.str||10)+4,s.con=(s.con||10)+4,i.push("Increased Str/Con by +4 (Elite Tier)"));const a=E[s.type]||{hitDieType:8},d=Math.floor(((s.con||10)-10)/2),S=a.hitDieType/2+.5,x=Math.max(1,S+d),M=p.hp,n=Math.max(1,Math.round(M/x)),C=s.racialHD||0;if(s.racialHD!==void 0)s.racialHD=n;else if(s.classLevels&&s.classLevels.length>0){const o=s.classLevels[0];o.level=n}else s.racialHD=n;n!==C&&i.push(`Adjusted HD from ${C} to ${n} to match Target HP ${M}`);const _=Math.floor(n*S)+n*d;s.hp=_,s.hp_claimed=_,s.hd=`${n}d${a.hitDieType}${d>=0?"+":""}${n*d}`;let f=0;a.babProgression==="fast"?f=n:a.babProgression==="medium"?f=Math.floor(n*.75):f=Math.floor(n*.5),s.bab=f,s.bab_claimed=f;const $=Math.floor(2+n/2),m=Math.floor(n/3),l=a.goodSaves||[];s.fort=l.includes("Fort")?$:m,s.ref=l.includes("Ref")?$:m,s.will=l.includes("Will")?$:m,s.fort_save_claimed=s.fort,s.ref_save_claimed=s.ref,s.will_save_claimed=s.will;const g=v[s.size]||{acAttackMod:0,cmbCmdMod:0},A=Math.floor(((s.str||10)-10)/2),D=Math.floor(((s.dex||10)-10)/2);s.cmd=10+f+A+D+g.cmbCmdMod,s.cmd_claimed=s.cmd;const R=v[e.size]||{acAttackMod:0},z=10+Math.floor(((e.dex||10)-10)/2)+R.acAttackMod,y=(e.ac_claimed||e.ac)-z,T=10+D+g.acAttackMod;return s.ac=T+y,s.ac_claimed=s.ac,s.size!==e.size&&i.push(`Recalculated AC/CMD for size ${s.size}`),s.cr=h,s.xp=t,{block:s,changes:i}}function F(e){const t=[],s=a=>a===0?"â€”":a.toString();t.push(`${e.name}`),t.push(`CR ${e.cr}`),t.push(`XP ${e.xp}`);const i=e.gender?`${e.gender} `:"",u=(e.classLevels||[]).map(a=>`${a.className} ${a.level}`).join(", ");t.push(`${i}${e.size} ${e.type} ${u}`.trim()),t.push(`Init ${e.init>0?"+":""}${e.init}; Senses ${e.senses||""}; Perception +${e.perception||0}`),e.aura&&t.push(`Aura ${e.aura}`),t.push("DEFENSE");const r=[];e.ac_mods&&(e.ac_mods.touch&&r.push(`touch ${e.ac_mods.touch}`),e.ac_mods.flat_footed&&r.push(`flat-footed ${e.ac_mods.flat_footed}`)),t.push(`AC ${e.ac}, ${r.join(", ")}`),t.push(`hp ${e.hp} (${e.hd})`);const h=`Fort +${e.fort}, Ref +${e.ref}, Will +${e.will}`;t.push(h),e.defensive_abilities&&t.push(`Defensive Abilities ${e.defensive_abilities}`),e.dr&&t.push(`DR ${e.dr}`),e.immune&&t.push(`Immune ${e.immune}`),e.resist&&t.push(`Resist ${e.resist}`),e.sr&&t.push(`SR ${e.sr}`),t.push("OFFENSE");const p=e.speed_line||"Speed 30 ft.";if(t.push(p),e.melee&&t.push(`Melee ${e.melee}`),e.ranged&&t.push(`Ranged ${e.ranged}`),e.space&&e.reach&&t.push(`Space ${e.space} ft.; Reach ${e.reach} ft.`),e.special_attacks&&t.push(`Special Attacks ${e.special_attacks}`),t.push("STATISTICS"),t.push(`Str ${s(e.str)}, Dex ${s(e.dex)}, Con ${s(e.con)}, Int ${s(e.int)}, Wis ${s(e.wis)}, Cha ${s(e.cha)}`),t.push(`Base Atk +${e.bab_claimed}; CMB ${e.cmb_claimed}; CMD ${e.cmd_claimed}`),e.feats&&e.feats.length>0&&t.push(`Feats ${e.feats.join(", ")}`),e.skills&&e.skills.length>0){const a=e.skills.map(d=>`${d.name} +${d.value}`).join(", ");t.push(`Skills ${a}`)}if(e.languages&&e.languages.length>0&&t.push(`Languages ${e.languages.join(", ")}`),e.sq&&t.push(`SQ ${e.sq}`),t.push("ECOLOGY"),t.push(`Environment ${e.environment||"any"}`),t.push(`Organization ${e.organization||"solitary"}`),t.push(`Treasure ${e.treasure||"standard"}`),e.special_abilities&&e.special_abilities.length>0){t.push("SPECIAL ABILITIES");for(const a of e.special_abilities)t.push(`${a.name} (${a.type}) ${a.description}`)}return t.join(`
`)}export{F as f,L as s};
