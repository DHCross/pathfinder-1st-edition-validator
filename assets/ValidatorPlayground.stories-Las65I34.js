import{r as C,R as i}from"./iframe-Blxgeh6n.js";import{C as X,S as J,X as z,M as U,v as j}from"./validateBasics-DEY3oNcw.js";import"./preload-helper-PPVm8Dsz.js";function K(t){return t.replace(/\*\*/g,"").replace(/\*/g,"").replace(/__/g,"").replace(/\u2013|\u2014/g,"-").replace(/\u2212/g,"-").replace(/\n/g," ").replace(/\s+/g," ").trim()}function W(t){const s=t.split(`
`).map(d=>d.trim()).filter(Boolean),r=K(t),e={name:s[0]?.replace(/\*/g,"")||"Unnamed Creature",classLevels:[],feats:[],str:10,dex:10,con:10,int:10,wis:10,cha:10,hp:10,ac:10,fort:0,ref:0,will:0,bab:0,cr:"1",size:"Medium",type:"humanoid"},o=/(?:CR|Challenge Rating)\s*(\d+(?:[\/\.]\d+)?)/i,l=/XP\s*([0-9,]+)/i,m=/(LG|NG|CG|LN|N|CN|LE|NE|CE)\s+(Fine|Diminutive|Tiny|Small|Medium|Large|Huge|Gargantuan|Colossal)\s+([a-zA-Z\-\s]+)/i,f=/AC\s*(\d+)/i,a=/touch\s*(\d+)/i,c=/flat-footed\s*(\d+)/i,n=/(?:hp|HP)\s*(\d+)\s*(?:\(([^)]+)\))?/i,p=/Fort\s*\+?(-?\d+),\s*Ref\s*\+?(-?\d+),\s*Will\s*\+?(-?\d+)/i,h=/(?:Base Atk|Base Atk\.|Base Attack)\s*\+?(\d+)/i,u=/CMD\s*(\d+)/i,O=/Feats[:\s]+(.+?)(?:;|$|Skills|Languages|SQ|Ecology|Special Abilities)/i,G=/Treasure\s+(.+?)(?:$|\n|Special)/i,$=r.match(o);$&&(e.cr=$[1]);const M=r.match(l);M&&(e.xp=parseInt(M[1].replace(/,/g,"")));const y=r.match(m);y&&(e.alignment=y[1],e.size=y[2],e.type=y[3].trim());const I=r.match(f);I&&(e.ac_claimed=parseInt(I[1]));const R=r.match(a);R&&(e.touch_ac_claimed=parseInt(R[1]));const E=r.match(c);E&&(e.flat_footed_ac_claimed=parseInt(E[1]));const v=r.match(n);if(v){e.hp_claimed=parseInt(v[1]),e.hp=parseInt(v[1]);const d=v[2];if(d){const D=/(\d+)d/.exec(d);D&&(e.racialHD=parseInt(D[1]))}}const g=r.match(p);g&&(e.fort_save_claimed=parseInt(g[1]),e.fort=parseInt(g[1]),e.ref_save_claimed=parseInt(g[2]),e.ref=parseInt(g[2]),e.will_save_claimed=parseInt(g[3]),e.will=parseInt(g[3]));const S=r.match(h);S&&(e.bab_claimed=parseInt(S[1]),e.bab=parseInt(S[1]));const _=r.match(u);_&&(e.cmd_claimed=parseInt(_[1]),e.cmd=parseInt(_[1]));const B=/Str\s*(\d+)/i.exec(r),F=/Dex\s*(\d+)/i.exec(r),T=/Con\s*(\d+)/i.exec(r),w=/Int\s*(\d+)/i.exec(r),b=/Wis\s*(\d+)/i.exec(r),A=/Cha\s*(\d+)/i.exec(r);B&&(e.str=parseInt(B[1])),F&&(e.dex=parseInt(F[1])),T&&(e.con=parseInt(T[1])),w&&(e.int=parseInt(w[1])),b&&(e.wis=parseInt(b[1])),A&&(e.cha=parseInt(A[1])),e.ac_claimed&&(e.ac=e.ac_claimed),e.touch_ac_claimed&&(e.touch=e.touch_ac_claimed),e.flat_footed_ac_claimed&&(e.flatFooted=e.flat_footed_ac_claimed);const P=r.match(O);P&&(e.feats=P[1].split(/[,;]+/).map(d=>d.trim()).filter(Boolean));const N=r.match(G);if(N){const d=N[1].toLowerCase();d.includes("npc gear")?e.treasureType="NPC Gear":d.includes("standard")?e.treasureType="Standard":d.includes("double")?e.treasureType="Double":d.includes("triple")?e.treasureType="Triple":d.includes("incidental")?e.treasureType="Incidental":d.includes("none")&&(e.treasureType="None")}return e}function Q(t){const{name:s,cr:r,xp:e,size:o,type:l}=t,m=t.alignment||"N",f=r,a=h=>Math.floor((h-10)/2),c=h=>{const u=a(h);return u>=0?`+${u}`:`${u}`},p=`${t.racialHD||1}d8+${a(t.con)}`;return`
${s}
CR ${f}
XP ${e?.toLocaleString()||"0"}
${m} ${o} ${l}
Init ${c(t.dex)}; Senses Perception +0
DEFENSE
AC ${t.ac_claimed||t.ac}, touch ${t.touch_ac_claimed||t.touch||10}, flat-footed ${t.flat_footed_ac_claimed||t.flatFooted||10}
hp ${t.hp_claimed||t.hp} (${p})
Fort +${t.fort_save_claimed||t.fort}, Ref +${t.ref_save_claimed||t.ref}, Will +${t.will_save_claimed||t.will}
OFFENSE
Speed 30 ft.
Melee weapon +${t.bab_claimed||t.bab} (1d8)
STATISTICS
Str ${t.str}, Dex ${t.dex}, Con ${t.con}, Int ${t.int}, Wis ${t.wis}, Cha ${t.cha}
Base Atk +${t.bab_claimed||t.bab}; CMB +${(t.bab_claimed||t.bab)+a(t.str)}; CMD ${t.cmd_claimed||t.cmd||10}
Feats ${t.feats?.join(", ")||"None"}
Treasure ${t.treasureType||"Standard"}
`.trim()}function H(t){const s=JSON.parse(JSON.stringify(t));let r=s.racialHD||0,e=0;const o=s.classLevels||[];for(const c of o){const n=X[c.className];if(!n){r+=c.level||0;continue}r+=c.level||0,n.babProgression==="Fast"?e+=c.level:n.babProgression==="Medium"?e+=Math.floor((c.level||0)*.75):e+=Math.floor((c.level||0)*.5)}r===0&&o.length===0&&(e=s.bab_claimed??s.bab??0),s.bab_claimed=e,s.bab=e;const l=J[s.size]||{cmbCmdMod:0},m=Math.floor(((s.str??10)-10)/2),f=Math.floor(((s.dex??10)-10)/2);s.cmd_claimed=10+e+m+f+(l.cmbCmdMod||0),s.cmd=s.cmd_claimed;let a=s.cr;return z[a]&&(s.xp=z[a]),s}function Z(t){const s=[],r=typeof t.cr=="number"?t.cr:parseInt(String(t.cr),10);if(isNaN(r))return{valid:!0,messages:s,status:"PASS"};const e=U.find(a=>a.cr===String(t.cr)||a.cr===t.cr_text);if(!e)return{valid:!0,messages:s,status:"PASS"};const o=t.hp_claimed??t.hp??void 0;if(o!==void 0&&typeof o=="number"){const a=o/e.hp;a<.7?s.push({severity:"warning",category:"benchmarks",message:`HP ${o} is dangerously low (<70%) for CR ${t.cr} (Benchmark: ${e.hp}). Creature is a "Glass Jaw".`}):a>1.5&&s.push({severity:"warning",category:"benchmarks",message:`HP ${o} is significantly high (>150%) for CR ${t.cr} (Benchmark: ${e.hp}). It may be a "Damage Sponge".`})}const l=t.ac_claimed??t.ac??void 0;if(l!==void 0&&typeof l=="number"){const a=l-e.ac;a<-3?s.push({severity:"warning",category:"benchmarks",message:`AC ${l} is very low (-${Math.abs(a)}) for CR ${t.cr} (Benchmark: ${e.ac}).`}):a>5&&s.push({severity:"warning",category:"benchmarks",message:`AC ${l} is very high (+${a}) for CR ${t.cr} (Benchmark: ${e.ac}).`})}const m=[{name:"Fort",val:t.fort_save_claimed},{name:"Ref",val:t.ref_save_claimed},{name:"Will",val:t.will_save_claimed}];for(const a of m)a.val!==void 0&&typeof a.val=="number"&&a.val<e.poorSave-2&&s.push({severity:"warning",category:"benchmarks",message:`${a.name} Save +${a.val} is critically weak for CR ${t.cr} (Benchmark Poor Save: +${e.poorSave}).`});return{valid:!s.some(a=>a.severity==="error"),messages:s,status:s.length>0?"WARN":"PASS"}}const L=`Fire Beetle
CR 1/3
XP 135
N Small vermin
Init +0; Senses Perception +0
DEFENSE
AC 12, touch 11, flat-footed 12
hp 4 (1d8)
Fort +2, Ref +0, Will +0
OFFENSE
Speed 30 ft.
Melee bite +1 (1d4)
STATISTICS
Str 10, Dex 11, Con 11, Int 10, Wis 10, Cha 7
Base Atk +0; CMB -1; CMD 9
Feats Weapon Finesse
Treasure None`,V=()=>{const[t,s]=C.useState(L),[r,e]=C.useState(()=>H(W(L))),[o,l]=C.useState([]),m=a=>{const c=a.currentTarget.value;s(c);try{const n=W(c),p=H(n);e(p);const h=j(n),u=Z(n);l([h,u])}catch(n){console.error("Parse error:",n)}},f=a=>{switch(a){case"error":return"#dc2626";case"warning":return"#ea580c";case"info":return"#2563eb"}};return i.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem",padding:"1rem",fontFamily:"system-ui, sans-serif",height:"100vh",boxSizing:"border-box"}},i.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}},i.createElement("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600}},"ðŸ“ Raw Stat Block"),i.createElement("textarea",{value:t,onChange:m,style:{flex:1,padding:"0.75rem",fontFamily:"monospace",fontSize:"0.875rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",resize:"none",lineHeight:1.5},spellCheck:!1})),i.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",overflow:"auto"}},i.createElement("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600}},"âš–ï¸ Validation Results"),i.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"}},o.map((a,c)=>i.createElement("div",{key:c,style:{border:"1px solid #d1d5db",borderRadius:"0.375rem",padding:"0.75rem",backgroundColor:"#f9fafb"}},i.createElement("div",{style:{fontWeight:600,marginBottom:"0.5rem"}},a.messages[0]?.category||"Validation"),a.messages.length===0?i.createElement("div",{style:{color:"#059669",fontWeight:500}},"âœ“ PASS"):i.createElement("ul",{style:{margin:0,paddingLeft:"1.5rem"}},a.messages.map((n,p)=>i.createElement("li",{key:p,style:{color:f(n.severity),marginBottom:"0.25rem",fontSize:"0.875rem"}},i.createElement("strong",null,n.severity.toUpperCase(),":")," ",n.message,n.expected!==void 0&&i.createElement("div",{style:{fontSize:"0.75rem",marginTop:"0.25rem",color:"#6b7280"}},"Expected: ",JSON.stringify(n.expected)," | Actual: ",JSON.stringify(n.actual))))))))),i.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}},i.createElement("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600}},"âœ¨ Auto-Fixed Version"),i.createElement("textarea",{value:Q(r),readOnly:!0,style:{flex:1,padding:"0.75rem",fontFamily:"monospace",fontSize:"0.875rem",border:"1px solid #10b981",borderRadius:"0.375rem",resize:"none",backgroundColor:"#f0fdf4",lineHeight:1.5},spellCheck:!1})))};V.__docgenInfo={description:"",methods:[],displayName:"ValidatorPlayground"};const ee={title:"Validators/Rules Lawyer Workbench",component:V,parameters:{layout:"fullscreen"}},x={};x.parameters={...x.parameters,docs:{...x.parameters?.docs,source:{originalSource:"{}",...x.parameters?.docs?.source}}};const te=["InteractiveWorkbench"];export{x as InteractiveWorkbench,te as __namedExportsOrder,ee as default};
