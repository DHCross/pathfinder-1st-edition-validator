import{r as g,R as a}from"./iframe-D_60GUjX.js";import{M as $,C as L,S as k,X as z}from"./pf1e-data-tables-BqrvN3By.js";import{f as O}from"./pf1e-formatter-CbX6Uino.js";import"./preload-helper-PPVm8Dsz.js";const M=["Fine","Diminutive","Tiny","Small","Medium","Large","Huge","Gargantuan","Colossal"];function I(t,o){const e=M.indexOf(t);if(e===-1)return t;const s=Math.max(0,Math.min(M.length-1,e+o));return M[s]}function j(t){let o="1",e=1/0;for(const[s,f]of Object.entries(z)){const r=Math.abs(f-t);r<e&&(e=r,o=s)}return o}function F(t,o){const e=JSON.parse(JSON.stringify(t)),s=[],f=t.xp||400,r=o/f,h=j(o),m=$.find(d=>d.cr===h);if(!m)return s.push(`Could not find stats for CR ${h}`),{block:e,changes:s};if(r<=.75){const d=e.size;M.indexOf(d)>3&&(e.size=I(d,-1),s.push(`Reduced Size from ${d} to ${e.size} (Weak Tier)`)),e.str=Math.max(1,(e.str||10)-4),e.con=Math.max(1,(e.con||10)-4),s.push("Reduced Str/Con by -4 (Weak Tier)")}r>=1.25&&(e.str=(e.str||10)+4,e.con=(e.con||10)+4,s.push("Increased Str/Con by +4 (Elite Tier)"));const l=L[e.type]||{hitDieType:8},u=Math.floor(((e.con||10)-10)/2),n=l.hitDieType/2+.5,i=Math.max(1,n+u),D=m.hp,c=Math.max(1,Math.round(D/i)),E=e.racialHD||0;if(e.racialHD!==void 0)e.racialHD=c;else if(e.classLevels&&e.classLevels.length>0){const d=e.classLevels[0];d.level=c}else e.racialHD=c;c!==E&&s.push(`Adjusted HD from ${E} to ${c} to match Target HP ${D}`);const T=Math.floor(c*n)+c*u;e.hp=T,e.hp_claimed=T,e.hd=`${c}d${l.hitDieType}${u>=0?"+":""}${c*u}`;let p=0;l.babProgression==="fast"?p=c:l.babProgression==="medium"?p=Math.floor(c*.75):p=Math.floor(c*.5),e.bab=p,e.bab_claimed=p;const x=Math.floor(2+c/2),b=Math.floor(c/3),v=l.goodSaves||[];e.fort=v.includes("Fort")?x:b,e.ref=v.includes("Ref")?x:b,e.will=v.includes("Will")?x:b,e.fort_save_claimed=e.fort,e.ref_save_claimed=e.ref,e.will_save_claimed=e.will;const y=k[e.size]||{acAttackMod:0,cmbCmdMod:0},A=Math.floor(((e.str||10)-10)/2),_=Math.floor(((e.dex||10)-10)/2);e.cmd=10+p+A+_+y.cmbCmdMod,e.cmd_claimed=e.cmd;const B=k[t.size]||{acAttackMod:0},w=10+Math.floor(((t.dex||10)-10)/2)+B.acAttackMod,N=(t.ac_claimed||t.ac)-w,P=10+_+y.acAttackMod;return e.ac=P+N,e.ac_claimed=e.ac,e.size!==t.size&&s.push(`Recalculated AC/CMD for size ${e.size}`),e.cr=h,e.xp=o,{block:e,changes:s}}const H=({initialBlock:t})=>{const[o,e]=g.useState(t.xp||400),[s,f]=g.useState(t),[r,h]=g.useState([]);g.useEffect(()=>{const n=F(t,o);f(n.block),h(n.changes)},[o,t]);const m=Object.values(z).sort((n,i)=>n-i),l=m.findIndex(n=>n>=o),u=n=>{const i=parseInt(n.target.value);e(m[i])};return a.createElement("div",{className:"creature-scaler"},a.createElement("div",{className:"scaler-header"},a.createElement("h2",null,"Difficulty Scaler"),a.createElement("div",{className:"scaler-controls"},a.createElement("label",null,a.createElement("strong",null,"Target XP: ",o.toLocaleString())," (CR ",s.cr,")",a.createElement("input",{type:"range",min:"0",max:m.length-1,value:l===-1?0:l,onChange:u,style:{width:"100%"}})))),a.createElement("div",{className:"scaler-content"},a.createElement("div",{className:"scaler-block"},a.createElement("h3",null,"Scaled Stat Block"),a.createElement("pre",{className:"stat-block-display"},O(s))),a.createElement("div",{className:"scaler-changes"},a.createElement("h3",null,"Auto-Adjustments"),r.length===0?a.createElement("p",null,"No changes needed."):a.createElement("ul",null,r.map((n,i)=>a.createElement("li",{key:i},n))))))};H.__docgenInfo={description:"",methods:[],displayName:"CreatureScaler",props:{initialBlock:{required:!0,tsType:{name:"PF1eStatBlock"},description:""}}};const Z={title:"Components/CreatureScaler",component:H,parameters:{layout:"padded"}},R={name:"Chaos-Mutated Toad",cr:"1",xp:400,size:"Medium",type:"Outsider",subtypes:["Chaotic","Extraplanar"],racialHD:2,hp:15,ac:12,fort:4,ref:4,will:1,bab:2,str:12,dex:12,con:12,int:2,wis:10,cha:6,feats:["Toughness"],melee_line:"Bite +3 (1d6+1 plus grab)",special_attacks_line:"Tongue (Range 10 ft)",speed_line:"Speed 30 ft., swim 30 ft."},S={args:{initialBlock:R}},C={args:{initialBlock:{...R,name:"Greater Chaos Toad",cr:"5",xp:1600,racialHD:6,hp:55,size:"Large"}}};S.parameters={...S.parameters,docs:{...S.parameters?.docs,source:{originalSource:`{
  args: {
    initialBlock: sampleToad
  }
}`,...S.parameters?.docs?.source}}};C.parameters={...C.parameters,docs:{...C.parameters?.docs,source:{originalSource:`{
  args: {
    initialBlock: {
      ...sampleToad,
      name: "Greater Chaos Toad",
      cr: "5",
      xp: 1600,
      racialHD: 6,
      hp: 55,
      size: "Large"
    }
  }
}`,...C.parameters?.docs?.source}}};const K=["Default","HighLevel"];export{S as Default,C as HighLevel,K as __namedExportsOrder,Z as default};
