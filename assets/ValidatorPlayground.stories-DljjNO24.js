import{r as P,R as l}from"./iframe-7iKl-0sm.js";import{C as X,a as q,S as Q,X as O,M as j,v as K}from"./validateBasics-CetwHHmj.js";import"./preload-helper-PPVm8Dsz.js";function Z(e){return e.replace(/\*\*/g,"").replace(/\*/g,"").replace(/__/g,"").replace(/_/g,"").replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"').replace(/[\u2013\u2014]/g,"-").replace(/\u2212/g,"-").replace(/\u00A0/g," ").trim()}function G(e){const t=Z(e),a={name:t.split(`
`).map(c=>c.trim()).filter(Boolean)[0]||"Unnamed Creature",classLevels:[],feats:[],str:10,dex:10,con:10,int:10,wis:10,cha:10,hp:10,ac:10,fort:0,ref:0,will:0,bab:0,cr:"1",size:"Medium",type:"Humanoid"},o=t.match(/Speed\s+(.+?)(?=\n|Melee|Ranged|Space|Special|Str|Statistic)/i);o&&(a.speed_line="Speed "+o[1].trim());const d=t.match(/Melee\s+(.+?)(?=\n|Ranged|Space|Special|Str|Statistic)/i);d&&(a.melee_line="Melee "+d[1].trim());const f=t.match(/Ranged\s+(.+?)(?=\n|Space|Special|Str|Statistic)/i);f&&(a.ranged_line="Ranged "+f[1].trim());const m=t.match(/Special Attacks\s+(.+?)(?=\n|Str|Statistic|Spells)/i);m&&(a.special_attacks_line="Special Attacks "+m[1].trim());const s=t.match(/(?:Spells|Spell-Like).+?(?=STATISTICS|Str\s+\d)/s);s&&(a.spells_block=s[0].trim());const p=t.match(/SPECIAL ABILITIES(.+)$/s);p&&(a.special_abilities_block=`SPECIAL ABILITIES
`+p[1].trim());const r=t.match(/Skills\s+(.+?)(?=\n|Languages|SQ|Feats|Special|Gear|Treasure)/i);r&&(a.skills_line="Skills "+r[1].trim());const u=t.match(/Languages\s+(.+?)(?=\n|SQ|Feats|Special|Gear|Treasure)/i);u&&(a.languages_line="Languages "+u[1].trim());const _=t.match(/(?:Combat Gear|Other Gear|Equipment)\s+(.+?)(?=\n|Special|Treasure)/is);_&&(a.equipment_line="Equipment "+_[1].trim());const y=t.match(/Init\s*([+-]?\d+)/i);y&&(a.init_claimed=parseInt(y[1]));const M=t.match(/Perception\s*([+-]?\d+)/i);M&&(a.perception_claimed=parseInt(M[1]));const x=t.match(/(?:CR|Challenge Rating)\s*(\d+(?:[\/\.]\d+)?)/i);x&&(a.cr=x[1]);const I=t.match(/XP\s*([0-9,]+)/i);I&&(a.xp=parseInt(I[1].replace(/,/g,"")));const v=t.match(/(LG|NG|CG|LN|N|CN|LE|NE|CE)\s+(Fine|Diminutive|Tiny|Small|Medium|Large|Huge|Gargantuan|Colossal)\s+([a-zA-Z\-\s\(\)]+)/i);if(v){a.alignment=v[1],a.size=v[2];const c=v[3].trim();/Fiend|Devil|Demon|Daemon|Angel|Archon|Azata|Chaos-Beast/i.test(c)?a.type="Outsider":/Dragon/i.test(c)?a.type="Dragon":/Undead/i.test(c)?a.type="Undead":/Beast/i.test(c)?a.type="Magical Beast":a.type=c.split(" ")[0]}const L=/(Barbarian|Bard|Cleric|Druid|Fighter|Monk|Paladin|Ranger|Rogue|Sorcerer|Wizard|Adept|Aristocrat|Commoner|Expert|Warrior)\s+(\d+)/gi;let C;for(;(C=L.exec(t))!==null;)a.classLevels?.push({className:C[1],level:parseInt(C[2])});const E=t.match(/AC\s*(\d+)/i);E&&(a.ac_claimed=parseInt(E[1]));const D=t.match(/touch\s*(\d+)/i);D&&(a.touch_ac_claimed=parseInt(D[1]));const A=t.match(/flat-?footed\s*(\d+)/i);A&&(a.flat_footed_ac_claimed=parseInt(A[1]));const S=t.match(/(?:hp|HP)\s*(\d+)\s*(?:\(([^)]+)\))?/);if(S&&(a.hp_claimed=parseInt(S[1]),a.hp=parseInt(S[1]),S[2])){const c=/(\d+)d/.exec(S[2]);c&&(a.racialHD=parseInt(c[1]))}const n=a.classLevels?.reduce((c,U)=>c+U.level,0)||0;a.racialHD===n&&n>0&&(a.racialHD=0);const h=t.match(/Fort\s*\+?(-?\d+),\s*Ref\s*\+?(-?\d+),\s*Will\s*\+?(-?\d+)/i);h&&(a.fort_save_claimed=parseInt(h[1]),a.ref_save_claimed=parseInt(h[2]),a.will_save_claimed=parseInt(h[3]));const $=t.match(/(?:Base Atk|Base Atk\.|Base Attack)\s*\+?(\d+)/i);$&&(a.bab_claimed=parseInt($[1]));const g=t.match(/CMD\s*(\d+)/i);g&&(a.cmd_claimed=parseInt(g[1]));const R=/Str\s*(\d+)/i.exec(t),T=/Dex\s*(\d+)/i.exec(t),F=/Con\s*(\d+)/i.exec(t),w=/Int\s*(\d+)/i.exec(t),N=/Wis\s*(\d+)/i.exec(t),H=/Cha\s*(\d+)/i.exec(t);R&&(a.str=parseInt(R[1])),T&&(a.dex=parseInt(T[1])),F&&(a.con=parseInt(F[1])),w&&(a.int=parseInt(w[1])),N&&(a.wis=parseInt(N[1])),H&&(a.cha=parseInt(H[1])),a.ac_claimed&&(a.ac=a.ac_claimed);const z=t.match(/Feats[:\s]+(.+?)(?=\n|Skills|Languages|SQ|Ecology|Special Abilities)/i);z&&(a.feats=z[1].split(/[,;]/).map(c=>c.trim()).filter(Boolean));const W=t.match(/Treasure\s+(.+?)(?:$|\n)/i);if(W){const c=W[1].toLowerCase();c.includes("npc gear")?a.treasureType="NPC Gear":(c.includes("standard"),a.treasureType="Standard")}return a}function Y(e){const{name:t,cr:i,xp:a,size:o,type:d}=e,f=e.alignment||"N",m=n=>Math.floor((n-10)/2),s=n=>m(n)>=0?`+${m(n)}`:`${m(n)}`;let p="";const r=e.classLevels?.reduce((n,h)=>n+h.level,0)||0;if(r>0&&(e.racialHD||0)===0){const n=e.classLevels[0],h=X[n.className],$=h?h.hitDieType:8,g=e.classLevels.reduce((R,T)=>R+T.level,0);p=`${g}d${$}+${m(e.con)*g}`}else{const n=e.racialHD||1,$=(q[e.type]||{hitDieType:8}).hitDieType,g=n+r;p=`${g}d${$}+${m(e.con)*g}`}const u=e.classLevels?.map(n=>`${n.className} ${n.level}`).join(", ")||"",_=u?`${f} ${o} ${d} ${u}`:`${f} ${o} ${d}`,y=e.init_claimed!==void 0?e.init_claimed>=0?`+${e.init_claimed}`:`${e.init_claimed}`:s(e.dex),M=e.perception_claimed!==void 0?e.perception_claimed>=0?`+${e.perception_claimed}`:`${e.perception_claimed}`:"+0",x=e.speed_line||"Speed 30 ft.",I=e.melee_line||`Melee weapon +${e.bab_claimed||0} (1d8)`,v=e.ranged_line?`${e.ranged_line}
`:"",L=e.special_attacks_line?`${e.special_attacks_line}
`:"",C=e.spells_block?`${e.spells_block}
`:"",E=e.skills_line?`${e.skills_line}
`:"",D=e.languages_line?`${e.languages_line}
`:"",A=e.equipment_line?`${e.equipment_line}
`:"",S=e.special_abilities_block?`
${e.special_abilities_block}`:"";return`
${t}
CR ${i}
XP ${a?.toLocaleString()||"0"}
${_}
Init ${y}; Senses Perception ${M}
DEFENSE
AC ${e.ac_claimed||e.ac}, touch ${e.touch_ac_claimed||10}, flat-footed ${e.flat_footed_ac_claimed||10}
hp ${e.hp_claimed||e.hp} (${p})
Fort +${e.fort_save_claimed||0}, Ref +${e.ref_save_claimed||0}, Will +${e.will_save_claimed||0}
OFFENSE
${x}
${I}
${v}${L}${C}STATISTICS
Str ${e.str}, Dex ${e.dex}, Con ${e.con}, Int ${e.int}, Wis ${e.wis}, Cha ${e.cha}
Base Atk +${e.bab_claimed||0}; CMB +${(e.bab_claimed||0)+m(e.str)}; CMD ${e.cmd_claimed||10}
Feats ${e.feats?.join(", ")||"None"}
${E}${D}${A}${S}
`.trim()}function V(e){const t=JSON.parse(JSON.stringify(e));let i=0;if(t.racialHD&&t.racialHD>0){const s=q[t.type];s?s.babProgression==="fast"?i+=t.racialHD:s.babProgression==="medium"?i+=Math.floor(t.racialHD*.75):i+=Math.floor(t.racialHD*.5):i+=Math.floor(t.racialHD*.75)}const a=t.classLevels||[];for(const s of a){const p=X[s.className];p&&(p.babProgression==="fast"?i+=s.level:p.babProgression==="medium"?i+=Math.floor(s.level*.75):i+=Math.floor(s.level*.5))}(t.racialHD||0)===0&&a.length===0&&(i=t.bab_claimed??t.bab??0),t.bab_claimed=i,t.bab=i;const o=Q[t.size]||{cmbCmdMod:0},d=Math.floor(((t.str??10)-10)/2),f=Math.floor(((t.dex??10)-10)/2);t.cmd_claimed=10+i+d+f+(o.cmbCmdMod||0),t.cmd=t.cmd_claimed;let m=t.cr;return O[m]&&(t.xp=O[m]),t}function k(e){const t=[],i=typeof e.cr=="number"?e.cr:parseInt(String(e.cr),10);if(isNaN(i))return{valid:!0,messages:t,status:"PASS"};const a=j.find(s=>s.cr===String(e.cr)||s.cr===e.cr_text);if(!a)return{valid:!0,messages:t,status:"PASS"};const o=e.hp_claimed??e.hp??void 0;if(o!==void 0&&typeof o=="number"){const s=o/a.hp;s<.7?t.push({severity:"warning",category:"benchmarks",message:`HP ${o} is dangerously low (<70%) for CR ${e.cr} (Benchmark: ${a.hp}). Creature is a "Glass Jaw".`}):s>1.5&&t.push({severity:"warning",category:"benchmarks",message:`HP ${o} is significantly high (>150%) for CR ${e.cr} (Benchmark: ${a.hp}). It may be a "Damage Sponge".`})}const d=e.ac_claimed??e.ac??void 0;if(d!==void 0&&typeof d=="number"){const s=d-a.ac;s<-3?t.push({severity:"warning",category:"benchmarks",message:`AC ${d} is very low (-${Math.abs(s)}) for CR ${e.cr} (Benchmark: ${a.ac}).`}):s>5&&t.push({severity:"warning",category:"benchmarks",message:`AC ${d} is very high (+${s}) for CR ${e.cr} (Benchmark: ${a.ac}).`})}const f=[{name:"Fort",val:e.fort_save_claimed},{name:"Ref",val:e.ref_save_claimed},{name:"Will",val:e.will_save_claimed}];for(const s of f)s.val!==void 0&&typeof s.val=="number"&&s.val<a.poorSave-2&&t.push({severity:"warning",category:"benchmarks",message:`${s.name} Save +${s.val} is critically weak for CR ${e.cr} (Benchmark Poor Save: +${a.poorSave}).`});return{valid:!t.some(s=>s.severity==="error"),messages:t,status:t.length>0?"WARN":"PASS"}}const b=`Fire Beetle
CR 1/3
XP 135
N Small vermin
Init +0; Senses Perception +0
DEFENSE
AC 12, touch 11, flat-footed 12
hp 4 (1d8)
Fort +2, Ref +0, Will +0
OFFENSE
Speed 30 ft.
Melee bite +1 (1d4)
STATISTICS
Str 10, Dex 11, Con 11, Int 10, Wis 10, Cha 7
Base Atk +0; CMB -1; CMD 9
Feats Weapon Finesse
Treasure None`,J=()=>{const[e,t]=P.useState(b),[i,a]=P.useState(()=>V(G(b))),[o,d]=P.useState([]),f=s=>{const p=s.currentTarget.value;t(p);try{const r=G(p),u=V(r);a(u);const _=K(r),y=k(r);d([_,y])}catch(r){console.error("Parse error:",r)}},m=s=>{switch(s){case"error":return"#dc2626";case"warning":return"#ea580c";case"info":return"#2563eb"}};return l.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem",padding:"1rem",fontFamily:"system-ui, sans-serif",height:"100vh",boxSizing:"border-box"}},l.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}},l.createElement("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600}},"ðŸ“ Raw Stat Block"),l.createElement("textarea",{value:e,onChange:f,style:{flex:1,padding:"0.75rem",fontFamily:"monospace",fontSize:"0.875rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",resize:"none",lineHeight:1.5},spellCheck:!1})),l.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",overflow:"auto"}},l.createElement("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600}},"âš–ï¸ Validation Results"),l.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"}},o.map((s,p)=>l.createElement("div",{key:p,style:{border:"1px solid #d1d5db",borderRadius:"0.375rem",padding:"0.75rem",backgroundColor:"#f9fafb"}},l.createElement("div",{style:{fontWeight:600,marginBottom:"0.5rem"}},s.messages[0]?.category||"Validation"),s.messages.length===0?l.createElement("div",{style:{color:"#059669",fontWeight:500}},"âœ“ PASS"):l.createElement("ul",{style:{margin:0,paddingLeft:"1.5rem"}},s.messages.map((r,u)=>l.createElement("li",{key:u,style:{color:m(r.severity),marginBottom:"0.25rem",fontSize:"0.875rem"}},l.createElement("strong",null,r.severity.toUpperCase(),":")," ",r.message,r.expected!==void 0&&l.createElement("div",{style:{fontSize:"0.75rem",marginTop:"0.25rem",color:"#6b7280"}},"Expected: ",JSON.stringify(r.expected)," | Actual: ",JSON.stringify(r.actual))))))))),l.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}},l.createElement("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600}},"âœ¨ Auto-Fixed Version"),l.createElement("textarea",{value:Y(i),readOnly:!0,style:{flex:1,padding:"0.75rem",fontFamily:"monospace",fontSize:"0.875rem",border:"1px solid #10b981",borderRadius:"0.375rem",resize:"none",backgroundColor:"#f0fdf4",lineHeight:1.5},spellCheck:!1})))};J.__docgenInfo={description:"",methods:[],displayName:"ValidatorPlayground"};const se={title:"Validators/Rules Lawyer Workbench",component:J,parameters:{layout:"fullscreen"}},B={};B.parameters={...B.parameters,docs:{...B.parameters?.docs,source:{originalSource:"{}",...B.parameters?.docs?.source}}};const ie=["InteractiveWorkbench"];export{B as InteractiveWorkbench,ie as __namedExportsOrder,se as default};
