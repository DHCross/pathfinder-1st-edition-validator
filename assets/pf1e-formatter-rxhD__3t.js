import{M as w,C as E,S as x,X as H}from"./pf1e-data-tables-BqrvN3By.js";const D=["Fine","Diminutive","Tiny","Small","Medium","Large","Huge","Gargantuan","Colossal"];function I(e,s){const t=D.indexOf(e);if(t===-1)return e;const i=Math.max(0,Math.min(D.length-1,t+s));return D[i]}function F(e){let s="1",t=1/0;for(const[i,p]of Object.entries(H)){const c=Math.abs(p-e);c<t&&(t=c,s=i)}return s}function j(e,s){const t=JSON.parse(JSON.stringify(e)),i=[],p=e.xp||400,c=s/p,f=F(s),C=w.find(h=>h.cr===f);if(!C)return i.push(`Could not find stats for CR ${f}`),{block:t,changes:i};if(c<=.75){const h=t.size;D.indexOf(h)>3&&(t.size=I(h,-1),i.push(`Reduced Size from ${h} to ${t.size} (Weak Tier)`)),t.str=Math.max(1,(t.str||10)-4),t.con=Math.max(1,(t.con||10)-4),i.push("Reduced Str/Con by -4 (Weak Tier)")}c>=1.25&&(t.str=(t.str||10)+4,t.con=(t.con||10)+4,i.push("Increased Str/Con by +4 (Elite Tier)"));const u=E[t.type]||{hitDieType:8},o=Math.floor(((t.con||10)-10)/2),m=u.hitDieType/2+.5,S=Math.max(1,m+o),_=C.hp,a=Math.max(1,Math.round(_/S)),r=t.racialHD||0;if(t.racialHD!==void 0)t.racialHD=a;else if(t.classLevels&&t.classLevels.length>0){const h=t.classLevels[0];h.level=a}else t.racialHD=a;a!==r&&i.push(`Adjusted HD from ${r} to ${a} to match Target HP ${_}`);const $=Math.floor(a*m)+a*o;t.hp=$,t.hp_claimed=$,t.hd=`${a}d${u.hitDieType}${o>=0?"+":""}${a*o}`;let d=0;u.babProgression==="fast"?d=a:u.babProgression==="medium"?d=Math.floor(a*.75):d=Math.floor(a*.5),t.bab=d,t.bab_claimed=d;const l=Math.floor(2+a/2),M=Math.floor(a/3),n=u.goodSaves||[];t.fort=n.includes("Fort")?l:M,t.ref=n.includes("Ref")?l:M,t.will=n.includes("Will")?l:M,t.fort_save_claimed=t.fort,t.ref_save_claimed=t.ref,t.will_save_claimed=t.will;const g=x[t.size]||{acAttackMod:0,cmbCmdMod:0},y=Math.floor(((t.str||10)-10)/2),v=Math.floor(((t.dex||10)-10)/2);t.cmd=10+d+y+v+g.cmbCmdMod,t.cmd_claimed=t.cmd;const z=x[e.size]||{acAttackMod:0},T=10+Math.floor(((e.dex||10)-10)/2)+z.acAttackMod,A=(e.ac_claimed||e.ac)-T,R=10+v+g.acAttackMod;return t.ac=R+A,t.ac_claimed=t.ac,t.size!==e.size&&i.push(`Recalculated AC/CMD for size ${t.size}`),t.cr=f,t.xp=s,{block:t,changes:i}}function L(e){const s=[],t=n=>n==null||n===0?"—":n.toString();s.push(`${e.name}`),s.push(`CR ${e.cr}`),s.push(`XP ${e.xp}`);const i=(e.classLevels||[]).map(n=>`${n.className} ${n.level}`).join(", "),p=e.subtypes&&e.subtypes.length>0?` (${e.subtypes.join(", ")})`:"";s.push(`${e.alignment||"CN"} ${e.size} ${e.type}${p} ${i}`.trim());const c=Math.floor(((e.dex??10)-10)/2),f=e.init_claimed??c,C=f>=0?`+${f}`:`${f}`;e.speed_line;const u=e.perception_claimed!==void 0?`+${e.perception_claimed}`:"+0";s.push(`Init ${C}; Senses ${e.senses||""}; Perception ${u}`.trim()),s.push("DEFENSE");const o=[];(e.touch_ac_claimed||e.touch)&&o.push(`touch ${e.touch_ac_claimed||e.touch}`),(e.flat_footed_ac_claimed||e.flatFooted)&&o.push(`flat-footed ${e.flat_footed_ac_claimed||e.flatFooted}`),s.push(`AC ${e.ac_claimed||e.ac}${o.length>0?", "+o.join(", "):""}`),s.push(`hp ${t(e.hp)} (${e.hd||"—"})`);const m=e.fort_save_claimed??e.fort??0,S=e.ref_save_claimed??e.ref??0,_=e.will_save_claimed??e.will??0,a=`Fort ${m>=0?"+":""}${m}, Ref ${S>=0?"+":""}${S}, Will ${_>=0?"+":""}${_}`;s.push(a),s.push("OFFENSE"),e.speed_line&&s.push(e.speed_line),e.melee_line&&s.push(e.melee_line),e.ranged_line&&s.push(e.ranged_line),e.special_attacks_line&&s.push(e.special_attacks_line),s.push("STATISTICS"),s.push(`Str ${t(e.str)}, Dex ${t(e.dex)}, Con ${t(e.con)}, Int ${t(e.int)}, Wis ${t(e.wis)}, Cha ${t(e.cha)}`);const r=e.bab_claimed??e.bab??0,$=Math.floor(((e.str??10)-10)/2),d=x[e.size]||{cmbCmdMod:0},l=e.cmb??r+$+(d.cmbCmdMod||0),M=e.cmd_claimed??e.cmd??10+r+$+Math.floor(((e.dex??10)-10)/2)+(d.cmbCmdMod||0);return s.push(`Base Atk ${r>=0?`+${r}`:r}; CMB ${l>=0?`+${l}`:l}; CMD ${M}`),e.feats&&e.feats.length>0&&s.push(`Feats ${e.feats.join(", ")}`),e.skills_line&&s.push(e.skills_line),e.languages_line&&s.push(e.languages_line),e.equipment_line&&s.push(e.equipment_line),s.push("ECOLOGY"),s.push(`Environment ${e.economicTier||"any"}`),s.push("Organization solitary"),s.push(`Treasure ${e.treasureType||"standard"}`),e.special_abilities_block&&(s.push("SPECIAL ABILITIES"),s.push(e.special_abilities_block)),s.join(`
`)}export{L as f,j as s};
