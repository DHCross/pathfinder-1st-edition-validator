import{M as E,C as H,S as x,X as I}from"./pf1e-data-tables-BqrvN3By.js";const h=["Fine","Diminutive","Tiny","Small","Medium","Large","Huge","Gargantuan","Colossal"];function w(e,t){const s=h.indexOf(e);if(s===-1)return e;const a=Math.max(0,Math.min(h.length-1,s+t));return h[a]}function F(e){let t="1",s=1/0;for(const[a,c]of Object.entries(I)){const n=Math.abs(c-e);n<s&&(s=n,t=a)}return t}function j(e,t){const s=JSON.parse(JSON.stringify(e)),a=[],c=e.xp||400,n=t/c,f=F(t),o=E.find(d=>d.cr===f);if(!o)return a.push(`Could not find stats for CR ${f}`),{block:s,changes:a};if(n<=.75){const d=s.size;h.indexOf(d)>3&&(s.size=w(d,-1),a.push(`Reduced Size from ${d} to ${s.size} (Weak Tier)`)),s.str=Math.max(1,(s.str||10)-4),s.con=Math.max(1,(s.con||10)-4),a.push("Reduced Str/Con by -4 (Weak Tier)")}n>=1.25&&(s.str=(s.str||10)+4,s.con=(s.con||10)+4,a.push("Increased Str/Con by +4 (Elite Tier)"));const u=H[s.type]||{hitDieType:8},l=Math.floor(((s.con||10)-10)/2),$=u.hitDieType/2+.5,y=Math.max(1,$+l),M=o.hp,i=Math.max(1,Math.round(M/y)),C=s.racialHD||0;if(s.racialHD!==void 0)s.racialHD=i;else if(s.classLevels&&s.classLevels.length>0){const d=s.classLevels[0];d.level=i}else s.racialHD=i;i!==C&&a.push(`Adjusted HD from ${C} to ${i} to match Target HP ${M}`);const S=Math.floor(i*$)+i*l;s.hp=S,s.hp_claimed=S,s.hd=`${i}d${u.hitDieType}${l>=0?"+":""}${i*l}`;let r=0;u.babProgression==="fast"?r=i:u.babProgression==="medium"?r=Math.floor(i*.75):r=Math.floor(i*.5),s.bab=r,s.bab_claimed=r;const p=Math.floor(2+i/2),m=Math.floor(i/3),_=u.goodSaves||[];s.fort=_.includes("Fort")?p:m,s.ref=_.includes("Ref")?p:m,s.will=_.includes("Will")?p:m,s.fort_save_claimed=s.fort,s.ref_save_claimed=s.ref,s.will_save_claimed=s.will;const D=x[s.size]||{acAttackMod:0,cmbCmdMod:0},T=Math.floor(((s.str||10)-10)/2),g=Math.floor(((s.dex||10)-10)/2);s.cmd=10+r+T+g+D.cmbCmdMod,s.cmd_claimed=s.cmd;const v=x[e.size]||{acAttackMod:0},z=10+Math.floor(((e.dex||10)-10)/2)+v.acAttackMod,A=(e.ac_claimed||e.ac)-z,R=10+g+D.acAttackMod;return s.ac=R+A,s.ac_claimed=s.ac,s.size!==e.size&&a.push(`Recalculated AC/CMD for size ${s.size}`),s.cr=f,s.xp=t,{block:s,changes:a}}function L(e){const t=[],s=o=>o===0?"â€”":o.toString();t.push(`${e.name}`),t.push(`CR ${e.cr}`),t.push(`XP ${e.xp}`);const a=(e.classLevels||[]).map(o=>`${o.className} ${o.level}`).join(", "),c=e.subtypes&&e.subtypes.length>0?` (${e.subtypes.join(", ")})`:"";t.push(`${e.alignment||"CN"} ${e.size} ${e.type}${c} ${a}`.trim()),t.push("Init undefined; Senses ; Perception +0"),t.push("DEFENSE");const n=[];(e.touch_ac_claimed||e.touch)&&n.push(`touch ${e.touch_ac_claimed||e.touch}`),(e.flat_footed_ac_claimed||e.flatFooted)&&n.push(`flat-footed ${e.flat_footed_ac_claimed||e.flatFooted}`),t.push(`AC ${e.ac_claimed||e.ac}${n.length>0?", "+n.join(", "):""}`),t.push(`hp ${e.hp} (${e.hd})`);const f=`Fort +${e.fort}, Ref +${e.ref}, Will +${e.will}`;return t.push(f),t.push("OFFENSE"),e.speed_line&&t.push(e.speed_line),e.melee_line&&t.push(e.melee_line),e.ranged_line&&t.push(e.ranged_line),e.special_attacks_line&&t.push(e.special_attacks_line),t.push("STATISTICS"),t.push(`Str ${s(e.str)}, Dex ${s(e.dex)}, Con ${s(e.con)}, Int ${s(e.int)}, Wis ${s(e.wis)}, Cha ${s(e.cha)}`),t.push(`Base Atk +${e.bab_claimed}; CMB ${e.cmb_claimed}; CMD ${e.cmd_claimed}`),e.feats&&e.feats.length>0&&t.push(`Feats ${e.feats.join(", ")}`),e.skills_line&&t.push(e.skills_line),e.languages_line&&t.push(e.languages_line),e.equipment_line&&t.push(e.equipment_line),t.push("ECOLOGY"),t.push(`Environment ${e.economicTier||"any"}`),t.push("Organization solitary"),t.push(`Treasure ${e.treasureType||"standard"}`),e.special_abilities_block&&(t.push("SPECIAL ABILITIES"),t.push(e.special_abilities_block)),t.join(`
`)}export{L as f,j as s};
