import{R as c}from"./iframe-DTb8aPw_.js";import{C,a as $,M,S as D,X as S,W as h,T as E}from"./pf1e-data-tables-BqrvN3By.js";const H=({statBlock:e,validation:a,validationTarget:s})=>{const i=[...a.messages].sort((t,n)=>{const f={critical:0,warning:1,note:2};return f[t.severity]-f[n.severity]}),r=t=>{switch(t){case"critical":return"#ef4444";case"warning":return"#f59e0b";case"note":return"#9ca3af";default:return"#3b82f6"}},u=t=>{switch(t){case"critical":return"#fef2f2";case"warning":return"#fffbeb";case"note":return"#f9fafb";default:return"#eff6ff"}},l=t=>{switch(t){case"critical":return"ðŸ›‘";case"warning":return"âš ï¸";case"note":return"ðŸ“";default:return"â„¹ï¸"}},d=t=>{switch(t){case"PASS":return{backgroundColor:"#dcfce7",color:"#166534",borderColor:"#bbf7d0"};case"FAIL":return{backgroundColor:"#fee2e2",color:"#991b1b",borderColor:"#fecaca"};case"WARN":return{backgroundColor:"#fef9c3",color:"#854d0e",borderColor:"#fde047"};default:return{}}};return c.createElement("div",{style:{padding:"1.5rem",maxWidth:"42rem",margin:"0 auto",fontFamily:"sans-serif",border:"1px solid #e5e7eb",borderRadius:"0.5rem",boxShadow:"0 1px 2px 0 rgba(0, 0, 0, 0.05)",backgroundColor:"white"}},c.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",borderBottom:"1px solid #e5e7eb",paddingBottom:"1rem",marginBottom:"1rem"}},c.createElement("div",null,c.createElement("h2",{style:{fontSize:"1.5rem",fontWeight:"bold",color:"#111827",margin:0}},e.name||"Unnamed"),c.createElement("p",{style:{fontSize:"0.875rem",color:"#6b7280",margin:0}},e.size," ",e.type," â€¢ CR ",e.cr_text||e.cr)),c.createElement("span",{style:{padding:"0.25rem 1rem",borderRadius:"9999px",fontSize:"0.875rem",fontWeight:"bold",border:"1px solid",...d(a.status||"PASS")}},a.status," ",s?`(${s==="fixed"?"Fixed":"Raw"})`:"")),c.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"}},i.length===0?c.createElement("div",{style:{textAlign:"center",padding:"2rem",color:"#9ca3af",fontStyle:"italic",border:"2px dashed #e5e7eb",borderRadius:"0.5rem"}},"âœ¨ No issues found. This stat block is mechanically perfect."):i.map((t,n)=>c.createElement("div",{key:n,style:{padding:"0.75rem",borderRadius:"0.25rem",borderLeftWidth:"4px",borderLeftStyle:"solid",border:"1px solid #e5e7eb",borderLeftColor:r(t.severity),backgroundColor:u(t.severity)}},c.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.25rem"}},c.createElement("span",{style:{fontWeight:"bold",display:"flex",alignItems:"center",gap:"0.25rem"}},l(t.severity)," ",t.category.toUpperCase())),c.createElement("p",{style:{color:"#1f2937",margin:0}},t.message),(t.expected!==void 0||t.actual!==void 0)&&c.createElement("div",{style:{marginTop:"0.5rem",fontSize:"0.75rem",fontFamily:"monospace",backgroundColor:"rgba(255,255,255,0.5)",padding:"0.25rem",borderRadius:"0.25rem",display:"inline-block"}},t.actual!==void 0&&c.createElement("span",{style:{marginRight:"0.5rem",color:"#dc2626"}},"Found: ",JSON.stringify(t.actual)),t.expected!==void 0&&c.createElement("span",{style:{color:"#16a34a"}},"Expected: ",JSON.stringify(t.expected)))))))};H.__docgenInfo={description:"",methods:[],displayName:"ValidatorDisplay",props:{statBlock:{required:!0,tsType:{name:"PF1eStatBlock"},description:""},validation:{required:!0,tsType:{name:"ValidationResult"},description:""},validationTarget:{required:!1,tsType:{name:"union",raw:"'raw' | 'fixed'",elements:[{name:"literal",value:"'raw'"},{name:"literal",value:"'fixed'"}]},description:""}}};function T(e){const a=[];let s=!1,i=e.racialHD||0,r=0;if(e.racialHD&&e.racialHD>0){const o=C[e.type];o?o.babProgression==="fast"?r+=e.racialHD:o.babProgression==="medium"?r+=Math.floor(e.racialHD*.75):r+=Math.floor(e.racialHD*.5):r+=Math.floor(e.racialHD*.75)}for(const o of e.classLevels||[]){const m=$[o.className];m&&(i+=o.level,m.babProgression==="fast"?r+=o.level:m.babProgression==="medium"?r+=Math.floor(o.level*.75):r+=Math.floor(o.level*.5))}const u=(e.cr||"").toString(),l=M.find(o=>o.cr===u);if(l){const o=Math.max(1,Math.round((l.hp||1)/4.5)),m=o*2;i>m&&i>=3&&(s=!0,a.push({category:"structure",severity:"critical",message:`HD/CR Mismatch: ${i} Hit Dice is inappropriate for CR ${e.cr}. This HD count suggests a much higher CR than declared and is a structural contradiction.`,expected:`${o} HD (max ${m})`,actual:`${i} HD`}))}const d=D[e.size]||{cmbCmdMod:0},t=Math.floor(((e.str||10)-10)/2),n=Math.floor(((e.dex||10)-10)/2);let f="MATCH";e.bab_claimed!==void 0&&e.bab_claimed!==r&&(f="MISMATCH",s=!0,a.push({category:"basics",severity:"critical",message:`Base Attack Bonus (BAB) +${e.bab_claimed} is illegal for ${i} HD. It must be +${r} according to ${e.type} progression.`,expected:r,actual:e.bab_claimed}));const p=10+r+t+n+d.cmbCmdMod,b=10+(e.bab_claimed||0)+t+n+d.cmbCmdMod;e.cmd_claimed&&(e.cmd_claimed===p||(e.cmd_claimed===b&&f==="MISMATCH"?a.push({category:"basics",severity:"warning",message:`CMD ${e.cmd_claimed} matches the source's (incorrect) BAB of +${e.bab_claimed}. If BAB were corrected to +${r}, CMD would be ${p}.`,expected:p,actual:e.cmd_claimed}):(s=!0,a.push({category:"basics",severity:"critical",message:`Calculated CMD is ${p} (10 + Legal BAB ${r} + Str ${t} + Dex ${n} + Size ${d.cmbCmdMod}), but stat block claims ${e.cmd_claimed}.`,expected:p,actual:e.cmd_claimed}))));const y=Math.ceil(i/2),v=e.feats?.length||0;v<y&&a.push({category:"basics",severity:"warning",message:`Creature has ${i} HD and should have at least ${y} feats, but only lists ${v}.`,expected:y,actual:v});const g=S[e.cr];return g&&e.xp!==g&&(s=!0,a.push({category:"basics",severity:"critical",message:`XP ${e.xp} does not match canonical value ${g} for CR ${e.cr}. (Source: Core Rulebook Experience Point Awards table)`,expected:g,actual:e.xp})),{valid:!s,status:s?"FAIL":a.length>0?"WARN":"PASS",messages:a}}function N(e){const a=[];if(e.gearValue===void 0)return{valid:!0,messages:[{severity:"note",category:"economy",message:"No gear value provided; skipping economy validation."}]};const s=L(e),i=w(e,s);if(i===null)return a.push({severity:"warning",category:"economy",message:`Unable to determine expected wealth for ${s} tier.`}),{valid:!0,messages:a};const r=e.gearValue,l=(r-i)/i*100,d=15;Math.abs(l)<=d?a.push({severity:"note",category:"economy",message:`Wealth is on target for ${s} (${r} gp vs expected ${i} gp).`,expected:i,actual:r}):l>d?a.push({severity:"warning",category:"economy",message:`Over-geared: ${s} has ${r} gp, expected ~${i} gp (+${l.toFixed(1)}%).`,expected:i,actual:r}):a.push({severity:"warning",category:"economy",message:`Under-geared: ${s} has ${r} gp, expected ~${i} gp (${l.toFixed(1)}%).`,expected:i,actual:r});let t="PASS";return a.some(n=>n.severity==="critical")?t="FAIL":a.some(n=>n.severity==="warning")&&(t="WARN"),{valid:Math.abs(l)<=d,messages:a,status:t}}function L(e){if(e.economicTier)return e.economicTier;const a=e.racialHD||0,s=e.classLevels||[],i=["Warrior","Expert","Commoner","Adept","Aristocrat"],u=s.filter(t=>!i.includes(t.className)).reduce((t,n)=>t+n.level,0),d=s.filter(t=>i.includes(t.className)).reduce((t,n)=>t+n.level,0);return u>=a&&u>0?"Heroic NPC":d>0?"Basic NPC":"Monster"}function w(e,a){if(a==="Heroic NPC"){const s=x(e);return s<1||s>20?null:h.heroicNpc[s]||null}if(a==="Basic NPC"){const s=x(e);return s<1||s>20?null:h.basicNpc[s]||null}if(a==="Monster"){const s=e.cr,i=E[s];if(!i)return null;let r=i.medium;return e.treasureType==="Double"?r*=2:e.treasureType==="Triple"?r*=3:e.treasureType==="Incidental"?r*=.5:e.treasureType==="None"&&(r=0),r}return null}function x(e){if(e.claimedEffectiveLevel!==void 0)return e.claimedEffectiveLevel;const a=e.racialHD||0,i=(e.classLevels||[]).reduce((r,u)=>r+u.level,0);return a+i}export{H as V,N as a,T as v};
