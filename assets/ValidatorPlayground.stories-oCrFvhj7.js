import{r as F,R as l}from"./iframe-DLFPKLEd.js";import{C as X,a as q,S as Q,X as O,M as j,v as K}from"./validateBasics-CetwHHmj.js";import"./preload-helper-PPVm8Dsz.js";function Z(e){return e.replace(/\*\*/g,"").replace(/\*/g,"").replace(/__/g,"").replace(/_/g,"").replace(/[\u2018\u2019]/g,"'").replace(/[\u201C\u201D]/g,'"').replace(/[\u2013\u2014]/g,"-").replace(/\u2212/g,"-").replace(/\u00A0/g," ").trim()}function G(e){const a=Z(e),t={name:a.split(`
`).map(c=>c.trim()).filter(Boolean)[0]||"Unnamed Creature",classLevels:[],feats:[],str:10,dex:10,con:10,int:10,wis:10,cha:10,hp:10,ac:10,fort:0,ref:0,will:0,bab:0,cr:"1",size:"Medium",type:"Humanoid"},o=a.match(/Melee\s+(.+?)(?=\n|Ranged|Space|Special|Str|Statistic)/i);o&&(t.melee_line="Melee "+o[1].trim());const d=a.match(/Ranged\s+(.+?)(?=\n|Space|Special|Str|Statistic)/i);d&&(t.ranged_line="Ranged "+d[1].trim());const f=a.match(/Speed\s+(.+?)(?=\n|Melee|Ranged|Space|Special|Str|Statistic)/i);f&&(t.speed_line="Speed "+f[1].trim());const m=a.match(/Special Attacks\s+(.+?)(?=\n|Str|Statistic|Spells)/i);m&&(t.special_attacks_line="Special Attacks "+m[1].trim());const s=a.match(/(?:Spells|Spell-Like).+?(?=STATISTICS|Str\s+\d)/s);s&&(t.spells_block=s[0].trim());const p=a.match(/SPECIAL ABILITIES(.+)$/s);p&&(t.special_abilities_block=`SPECIAL ABILITIES
`+p[1].trim());const r=a.match(/Skills\s+(.+?)(?=\n|Languages|SQ|Feats|Special|Gear|Treasure)/i);r&&(t.skills_line="Skills "+r[1].trim());const h=a.match(/Languages\s+(.+?)(?=\n|SQ|Feats|Special|Gear|Treasure)/i);h&&(t.languages_line="Languages "+h[1].trim());const S=a.match(/(?:Combat Gear|Other Gear|Equipment)\s+(.+?)(?=\n|Special|Treasure)/is);S&&(t.equipment_line="Equipment "+S[1].trim());const y=a.match(/(?:CR|Challenge Rating)\s*(\d+(?:[\/\.]\d+)?)/i);y&&(t.cr=y[1]);const x=a.match(/XP\s*([0-9,]+)/i);x&&(t.xp=parseInt(x[1].replace(/,/g,"")));const v=a.match(/(LG|NG|CG|LN|N|CN|LE|NE|CE)\s+(Fine|Diminutive|Tiny|Small|Medium|Large|Huge|Gargantuan|Colossal)\s+([a-zA-Z\-\s\(\)]+)/i);if(v){t.alignment=v[1],t.size=v[2];const c=v[3].trim();/Fiend|Devil|Demon|Daemon|Angel|Archon|Azata|Chaos-Beast/i.test(c)?t.type="Outsider":/Dragon/i.test(c)?t.type="Dragon":/Undead/i.test(c)?t.type="Undead":/Beast/i.test(c)?t.type="Magical Beast":t.type=c.split(" ")[0]}const L=/(Barbarian|Bard|Cleric|Druid|Fighter|Monk|Paladin|Ranger|Rogue|Sorcerer|Wizard|Adept|Aristocrat|Commoner|Expert|Warrior)\s+(\d+)/gi;let M;for(;(M=L.exec(a))!==null;)t.classLevels?.push({className:M[1],level:parseInt(M[2])});const I=a.match(/AC\s*(\d+)/i);I&&(t.ac_claimed=parseInt(I[1]));const E=a.match(/touch\s*(\d+)/i);E&&(t.touch_ac_claimed=parseInt(E[1]));const D=a.match(/flat-?footed\s*(\d+)/i);D&&(t.flat_footed_ac_claimed=parseInt(D[1]));const _=a.match(/(?:hp|HP)\s*(\d+)\s*(?:\(([^)]+)\))?/);if(_&&(t.hp_claimed=parseInt(_[1]),t.hp=parseInt(_[1]),_[2])){const c=/(\d+)d/.exec(_[2]);c&&(t.racialHD=parseInt(c[1]))}const A=t.classLevels?.reduce((c,U)=>c+U.level,0)||0;t.racialHD===A&&A>0&&(t.racialHD=0);const $=a.match(/Fort\s*\+?(-?\d+),\s*Ref\s*\+?(-?\d+),\s*Will\s*\+?(-?\d+)/i);$&&(t.fort_save_claimed=parseInt($[1]),t.ref_save_claimed=parseInt($[2]),t.will_save_claimed=parseInt($[3]));const n=a.match(/(?:Base Atk|Base Atk\.|Base Attack)\s*\+?(\d+)/i);n&&(t.bab_claimed=parseInt(n[1]));const u=a.match(/CMD\s*(\d+)/i);u&&(t.cmd_claimed=parseInt(u[1]));const C=/Str\s*(\d+)/i.exec(a),g=/Dex\s*(\d+)/i.exec(a),R=/Con\s*(\d+)/i.exec(a),T=/Int\s*(\d+)/i.exec(a),P=/Wis\s*(\d+)/i.exec(a),w=/Cha\s*(\d+)/i.exec(a);C&&(t.str=parseInt(C[1])),g&&(t.dex=parseInt(g[1])),R&&(t.con=parseInt(R[1])),T&&(t.int=parseInt(T[1])),P&&(t.wis=parseInt(P[1])),w&&(t.cha=parseInt(w[1])),t.ac_claimed&&(t.ac=t.ac_claimed),t.touch_ac_claimed&&(t.touch=t.touch_ac_claimed),t.flat_footed_ac_claimed&&(t.flatFooted=t.flat_footed_ac_claimed);const N=a.match(/Init\s*([+-]?\d+)/i);N&&(t.init_claimed=parseInt(N[1]));const H=a.match(/Perception\s*([+-]?\d+)/i);H&&(t.perception_claimed=parseInt(H[1]));const z=a.match(/Feats[:\s]+(.+?)(?=\n|Skills|Languages|SQ|Ecology|Special Abilities)/i);z&&(t.feats=z[1].split(/[,;]/).map(c=>c.trim()).filter(Boolean));const W=a.match(/Treasure\s+(.+?)(?:$|\n)/i);if(W){const c=W[1].toLowerCase();c.includes("npc gear")?t.treasureType="NPC Gear":(c.includes("standard"),t.treasureType="Standard")}return t}function Y(e){const{name:a,cr:i,xp:t,size:o,type:d}=e,f=e.alignment||"N",m=n=>Math.floor((n-10)/2),s=n=>m(n)>=0?`+${m(n)}`:`${m(n)}`;let p="";const r=e.classLevels?.reduce((n,u)=>n+u.level,0)||0;if(r>0&&(e.racialHD||0)===0){const n=e.classLevels[0],u=X[n.className],C=u?u.hitDieType:8,g=e.classLevels.reduce((R,T)=>R+T.level,0);p=`${g}d${C}+${m(e.con)*g}`}else{const n=e.racialHD||1,C=(q[e.type]||{hitDieType:8}).hitDieType,g=n+r;p=`${g}d${C}+${m(e.con)*g}`}const h=e.classLevels?.map(n=>`${n.className} ${n.level}`).join(", ")||"",S=h?`${f} ${o} ${d} ${h}`:`${f} ${o} ${d}`,y=e.melee_line||`Melee weapon +${e.bab_claimed||0} (1d8)`,x=e.ranged_line?`${e.ranged_line}
`:"",v=e.special_attacks_line?`${e.special_attacks_line}
`:"",L=e.spells_block?`${e.spells_block}
`:"",M=e.skills_line?`${e.skills_line}
`:"",I=e.languages_line?`${e.languages_line}
`:"",E=e.equipment_line?`${e.equipment_line}
`:"",D=e.special_abilities_block?`
${e.special_abilities_block}`:"",_=e.speed_line||"Speed 30 ft.",A=e.init_claimed!==void 0?e.init_claimed>=0?`+${e.init_claimed}`:`${e.init_claimed}`:s(e.dex),$=e.perception_claimed!==void 0?e.perception_claimed>=0?`+${e.perception_claimed}`:`${e.perception_claimed}`:"+0";return`
${a}
CR ${i}
XP ${t?.toLocaleString()||"0"}
${S}
Init ${A}; Senses Perception ${$}
DEFENSE
AC ${e.ac_claimed||e.ac}, touch ${e.touch_ac_claimed||10}, flat-footed ${e.flat_footed_ac_claimed||10}
hp ${e.hp_claimed||e.hp} (${p})
Fort +${e.fort_save_claimed||0}, Ref +${e.ref_save_claimed||0}, Will +${e.will_save_claimed||0}
OFFENSE
${_}
${y}
${x}${v}${L}STATISTICS
Str ${e.str}, Dex ${e.dex}, Con ${e.con}, Int ${e.int}, Wis ${e.wis}, Cha ${e.cha}
Base Atk +${e.bab_claimed||0}; CMB +${(e.bab_claimed||0)+m(e.str)}; CMD ${e.cmd_claimed||10}
Feats ${e.feats?.join(", ")||"None"}
${M}${I}${E}${D}
`.trim()}function V(e){const a=JSON.parse(JSON.stringify(e));let i=0;if(a.racialHD&&a.racialHD>0){const s=q[a.type];s?s.babProgression==="fast"?i+=a.racialHD:s.babProgression==="medium"?i+=Math.floor(a.racialHD*.75):i+=Math.floor(a.racialHD*.5):i+=Math.floor(a.racialHD*.75)}const t=a.classLevels||[];for(const s of t){const p=X[s.className];p&&(p.babProgression==="fast"?i+=s.level:p.babProgression==="medium"?i+=Math.floor(s.level*.75):i+=Math.floor(s.level*.5))}(a.racialHD||0)===0&&t.length===0&&(i=a.bab_claimed??a.bab??0),a.bab_claimed=i,a.bab=i;const o=Q[a.size]||{cmbCmdMod:0},d=Math.floor(((a.str??10)-10)/2),f=Math.floor(((a.dex??10)-10)/2);a.cmd_claimed=10+i+d+f+(o.cmbCmdMod||0),a.cmd=a.cmd_claimed;let m=a.cr;return O[m]&&(a.xp=O[m]),a}function k(e){const a=[],i=typeof e.cr=="number"?e.cr:parseInt(String(e.cr),10);if(isNaN(i))return{valid:!0,messages:a,status:"PASS"};const t=j.find(s=>s.cr===String(e.cr)||s.cr===e.cr_text);if(!t)return{valid:!0,messages:a,status:"PASS"};const o=e.hp_claimed??e.hp??void 0;if(o!==void 0&&typeof o=="number"){const s=o/t.hp;s<.7?a.push({severity:"warning",category:"benchmarks",message:`HP ${o} is dangerously low (<70%) for CR ${e.cr} (Benchmark: ${t.hp}). Creature is a "Glass Jaw".`}):s>1.5&&a.push({severity:"warning",category:"benchmarks",message:`HP ${o} is significantly high (>150%) for CR ${e.cr} (Benchmark: ${t.hp}). It may be a "Damage Sponge".`})}const d=e.ac_claimed??e.ac??void 0;if(d!==void 0&&typeof d=="number"){const s=d-t.ac;s<-3?a.push({severity:"warning",category:"benchmarks",message:`AC ${d} is very low (-${Math.abs(s)}) for CR ${e.cr} (Benchmark: ${t.ac}).`}):s>5&&a.push({severity:"warning",category:"benchmarks",message:`AC ${d} is very high (+${s}) for CR ${e.cr} (Benchmark: ${t.ac}).`})}const f=[{name:"Fort",val:e.fort_save_claimed},{name:"Ref",val:e.ref_save_claimed},{name:"Will",val:e.will_save_claimed}];for(const s of f)s.val!==void 0&&typeof s.val=="number"&&s.val<t.poorSave-2&&a.push({severity:"warning",category:"benchmarks",message:`${s.name} Save +${s.val} is critically weak for CR ${e.cr} (Benchmark Poor Save: +${t.poorSave}).`});return{valid:!a.some(s=>s.severity==="error"),messages:a,status:a.length>0?"WARN":"PASS"}}const b=`Fire Beetle
CR 1/3
XP 135
N Small vermin
Init +0; Senses Perception +0
DEFENSE
AC 12, touch 11, flat-footed 12
hp 4 (1d8)
Fort +2, Ref +0, Will +0
OFFENSE
Speed 30 ft.
Melee bite +1 (1d4)
STATISTICS
Str 10, Dex 11, Con 11, Int 10, Wis 10, Cha 7
Base Atk +0; CMB -1; CMD 9
Feats Weapon Finesse
Treasure None`,J=()=>{const[e,a]=F.useState(b),[i,t]=F.useState(()=>V(G(b))),[o,d]=F.useState([]),f=s=>{const p=s.currentTarget.value;a(p);try{const r=G(p),h=V(r);t(h);const S=K(r),y=k(r);d([S,y])}catch(r){console.error("Parse error:",r)}},m=s=>{switch(s){case"error":return"#dc2626";case"warning":return"#ea580c";case"info":return"#2563eb"}};return l.createElement("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"1rem",padding:"1rem",fontFamily:"system-ui, sans-serif",height:"100vh",boxSizing:"border-box"}},l.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}},l.createElement("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600}},"ðŸ“ Raw Stat Block"),l.createElement("textarea",{value:e,onChange:f,style:{flex:1,padding:"0.75rem",fontFamily:"monospace",fontSize:"0.875rem",border:"1px solid #d1d5db",borderRadius:"0.375rem",resize:"none",lineHeight:1.5},spellCheck:!1})),l.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem",overflow:"auto"}},l.createElement("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600}},"âš–ï¸ Validation Results"),l.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"}},o.map((s,p)=>l.createElement("div",{key:p,style:{border:"1px solid #d1d5db",borderRadius:"0.375rem",padding:"0.75rem",backgroundColor:"#f9fafb"}},l.createElement("div",{style:{fontWeight:600,marginBottom:"0.5rem"}},s.messages[0]?.category||"Validation"),s.messages.length===0?l.createElement("div",{style:{color:"#059669",fontWeight:500}},"âœ“ PASS"):l.createElement("ul",{style:{margin:0,paddingLeft:"1.5rem"}},s.messages.map((r,h)=>l.createElement("li",{key:h,style:{color:m(r.severity),marginBottom:"0.25rem",fontSize:"0.875rem"}},l.createElement("strong",null,r.severity.toUpperCase(),":")," ",r.message,r.expected!==void 0&&l.createElement("div",{style:{fontSize:"0.75rem",marginTop:"0.25rem",color:"#6b7280"}},"Expected: ",JSON.stringify(r.expected)," | Actual: ",JSON.stringify(r.actual))))))))),l.createElement("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"}},l.createElement("h2",{style:{margin:0,fontSize:"1.25rem",fontWeight:600}},"âœ¨ Auto-Fixed Version"),l.createElement("textarea",{value:Y(i),readOnly:!0,style:{flex:1,padding:"0.75rem",fontFamily:"monospace",fontSize:"0.875rem",border:"1px solid #10b981",borderRadius:"0.375rem",resize:"none",backgroundColor:"#f0fdf4",lineHeight:1.5},spellCheck:!1})))};J.__docgenInfo={description:"",methods:[],displayName:"ValidatorPlayground"};const se={title:"Validators/Rules Lawyer Workbench",component:J,parameters:{layout:"fullscreen"}},B={};B.parameters={...B.parameters,docs:{...B.parameters?.docs,source:{originalSource:"{}",...B.parameters?.docs?.source}}};const ie=["InteractiveWorkbench"];export{B as InteractiveWorkbench,ie as __namedExportsOrder,se as default};
